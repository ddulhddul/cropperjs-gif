{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./bower_components/gif.js/dist/gif.js","webpack:///./bower_components/gifuct-js/dist/gifuct-js.js","webpack:///./src/blob-creator.js","webpack:///./src/easy-gif.js","webpack:///./src/index.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;AClFA;AACA,aAAa,GAAG,IAAsD,EAAE,mBAAmB,KAAK,UAA0N,CAAC,aAAa,0BAA0B,yBAAyB,gBAAgB,UAAU,UAAU,0CAA0C,gBAAgB,OAAC,OAAO,oBAAoB,8CAA8C,kCAAkC,YAAY,YAAY,mCAAmC,iBAAiB,gBAAgB,sBAAsB,oBAAoB,0CAA0C,YAAY,WAAW,YAAY,SAAS,EAAE,oCAAoC,wBAAwB,8BAA8B,iDAAiD,4BAA4B,uCAAuC,yCAAyC,+CAA+C,oCAAoC,mDAAmD,8EAA8E,qBAAqB,aAAa,2CAA2C,oCAAoC,iCAAiC,mBAAmB,kFAAkF,gBAAgB,wBAAwB,SAAS,KAAK,mEAAmE,eAAe,YAAY,2BAA2B,qCAAqC,wBAAwB,yBAAyB,0BAA0B,MAAM,uCAAuC,MAAM,oDAAoD,MAAM,qDAAqD,0BAA0B,2BAA2B,6CAA6C,0BAA0B,qBAAqB,QAAQ,MAAM,kCAAkC,aAAa,2DAA2D,MAAM,wEAAwE,iCAAiC,mHAAmH,mDAAmD,uEAAuE,sDAAsD,6DAA6D,qCAAqC,qBAAqB,KAAK,mCAAmC,wCAAwC,+BAA+B,kLAAkL,sCAAsC,kBAAkB,aAAa,6DAA6D,oDAAoD,wEAAwE,gBAAgB,aAAa,4BAA4B,WAAW,WAAW,gCAAgC,oBAAoB,gBAAgB,aAAa,8DAA8D,2BAA2B,wEAAwE,kDAAkD,wBAAwB,mBAAmB,YAAY,yEAAyE,0BAA0B,yEAAyE,wBAAwB,aAAa,OAAO,EAAE,sEAAsE,WAAW,OAAO,0BAA0B,oBAAoB,cAAc,0BAA0B,KAAK,wBAAwB,yEAAyE,aAAa,yDAAyD,kBAAkB,6BAA6B,iCAAiC,wCAAwC,qDAAqD,YAAY,yBAAyB,yBAAyB,mCAAmC,6BAA6B,0CAA0C,gBAAgB,YAAY,6BAA6B,0BAA0B,oCAAoC,mBAAmB,+EAA+E,0BAA0B,aAAa,gDAAgD,QAAQ,6CAA6C,gEAAgE,oCAAoC,YAAY,oDAAoD,iBAAiB,kCAAkC,mCAAmC,4CAA4C,UAAU,kDAAkD,oCAAoC,yBAAyB,+BAA+B,uBAAuB,6BAA6B,uBAAuB,yCAAyC,0BAA0B,qBAAqB,GAAG,sCAAsC,gCAAgC,qCAAqC,0CAA0C,+HAA+H,yCAAyC,SAAS,0GAA0G,yHAAyH,2BAA2B,wDAAwD,6CAA6C,uBAAuB,GAAG,sCAAsC,2DAA2D,uBAAuB,mDAAmD,gBAAgB,uBAAuB,gCAAgC,yBAAyB,iCAAiC,aAAa,WAAW,mDAAmD,0BAA0B,IAAI,KAAK,sCAAsC,SAAS,gBAAgB,4CAA4C,oCAAoC,yBAAyB,2BAA2B,uBAAuB,UAAU,+IAA+I,eAAe,sBAAsB,sBAAsB,mBAAmB,mBAAmB,gBAAgB,eAAe,oBAAoB,sBAAsB,yBAAyB,qBAAqB,oBAAoB,mCAAmC,kBAAkB,4CAA4C,wBAAwB,wDAAwD,iCAAiC,2CAA2C,sBAAsB,WAAW,oBAAoB,uCAAuC,mBAAmB,wCAAwC,gBAAgB,+CAA+C,cAAc,kBAAkB,WAAW,SAAS,2CAA2C,0BAA0B,4CAA4C,6BAA6B,oCAAoC,8BAA8B,sCAAsC,iFAAiF,sBAAsB,qPAAqP,iBAAiB,sCAAsC,KAAK,qBAAqB,gCAAgC,iBAAiB,oCAAoC,KAAK,mBAAmB,KAAK,iCAAiC,gCAAgC,gCAAgC,uBAAuB,iBAAiB,mCAAmC,wDAAwD,mEAAmE,kBAAkB,iBAAiB,sBAAsB,2BAA2B,kBAAkB,WAAW,iCAAiC,mBAAmB,kBAAkB,mBAAmB,eAAe,YAAY,+BAA+B,sCAAsC,uBAAuB,KAAK,yBAAyB,mBAAmB,kBAAkB,wBAAwB,mBAAmB,gCAAgC,+BAA+B,WAAW,YAAY,kCAAkC,iBAAiB,MAAM,kCAAkC,mBAAmB,mBAAmB,2BAA2B,sCAAsC,6BAA6B,6DAA6D,YAAY,WAAW,sCAAsC,0CAA0C,yBAAyB,gBAAgB,eAAe,sCAAsC,mBAAmB,WAAW,gCAAgC,8CAA8C,iCAAiC,kEAAkE,+BAA+B,wCAAwC,uCAAuC,QAAQ,mBAAmB,4CAA4C,YAAY,kFAAkF,sBAAsB,6DAA6D,mCAAmC,sCAAsC,+CAA+C,oCAAoC,yBAAyB,sCAAsC,mBAAmB,kBAAkB,yBAAyB,0CAA0C,8BAA8B,KAAK,gCAAgC,yCAAyC,0EAA0E,MAAM,oBAAoB,wBAAwB,OAAO,KAAK,aAAa,uDAAuD,iCAAiC,oEAAoE,yBAAyB,SAAS,qBAAqB,yBAAyB,OAAO,KAAK,cAAc,gBAAgB,2BAA2B,OAAO,OAAO,aAAa,sBAAsB,4BAA4B,qBAAqB,KAAK,yBAAyB,uBAAuB,iBAAiB,EAAE,yCAAyC,yCAAyC,sBAAsB,gCAAgC,mCAAmC,uCAAuC,OAAO,oCAAoC,gCAAgC,yBAAyB,qEAAqE,gCAAgC,iCAAiC,2CAA2C,0EAA0E,2CAA2C,QAAQ,uBAAuB,8CAA8C,sCAAsC,wCAAwC,kCAAkC,oCAAoC,yDAAyD,yBAAyB,iCAAiC,sCAAsC,eAAe,iCAAiC,MAAM,mTAAmT,qBAAqB,qBAAqB,6BAA6B,6CAA6C,2BAA2B,yCAAyC,KAAK,kCAAkC,aAAa,6BAA6B,SAAS,oDAAoD,wBAAwB,OAAO,wCAAwC,WAAW,eAAe,mBAAmB,EAAE,8BAA8B,EAAE,GAAG,SAAS;AACnja;;;;;;;;;;;;ACFA,2CAAmB,gBAAgB,UAAU,UAAU,0CAA0C,gBAAgB,OAAC,OAAO,oBAAoB,8CAA8C,kCAAkC,YAAY,YAAY,mCAAmC,iBAAiB,gBAAgB,sBAAsB,oBAAoB,0CAA0C,YAAY,WAAW,YAAY,SAAS,GAAG;;AAE5b;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,KAAK;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,KAAK;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,gBAAgB,QAAQ;AACxB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,4B;AACA,EAAE;AACF;AACA,E;AACA;;AAEA;AACA,CAAC,GAAG;;AAEJ;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sC;AACA;AACA;;AAEA;AACA;AACA,aAAa,iBAAiB;AAC9B;AACA,4B;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;;AAEA;AACA;AACA,wCAAwC,kBAAkB,EAAE;AAC5D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA,CAAC,EAAE,iBAAiB;;AAEpB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,eAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,CAAC,GAAG;AACJ;;AAEA;;AAEA;;AAEA;AACA,CAAC,EAAE,UAAU;;AAEb;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,0BAA0B;AACvC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,qCAAqC,aAAa;;AAElD;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA,8CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,e;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,cAAc;AAC9B;AACA;AACA;;AAEA;AACA;AACA,aAAa,UAAU;AACvB;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,cAAc,UAAU;AACxB,oBAAoB;AACpB;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,oBAAoB,UAAU;AAC9B,kCAAkC,cAAc;AAChD;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,cAAc,eAAe;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,0BAA0B;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,CAAC,EAAE,4EAA4E;;AAE/E;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,wB;AACA,iCAAiC,mBAAmB;AACpD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,GAAG,2DAA2D;AAC9D,GAAG,gDAAgD;AACnD,GAAG;AACH,YAAY,sBAAsB;AAClC,cAAc,sBAAsB;AACpC,eAAe,WAAW;AAC1B,2BAA2B;AAC3B,IAAI;AACJ,GAAG,qDAAqD;AACxD,GAAG,6DAA6D;AAChE,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,GAAG,wDAAwD;AAC3D;AACA;AACA;AACA,KAAK,oDAAoD;AACzD,KAAK,mDAAmD;AACxD,KAAK,qDAAqD;AAC1D,KAAK,sDAAsD;AAC3D,KAAK;AACL,cAAc,WAAW;AACzB,kBAAkB,WAAW;AAC7B,YAAY,WAAW;AACvB,cAAc,sBAAsB;AACpC,YAAY;AACZ;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,IAAI;AACJ,GAAG;AACH;AACA;AACA,KAAK,mDAAmD;AACxD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,GAAG,2DAA2D;AAC9D,GAAG,iDAAiD;AACpD,G;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oEAAoE,cAAc;;AAElF;AACA;AACA;AACA,EAAE;AACF;AACA,GAAG,2DAA2D;AAC9D,GAAG,iDAAiD;AACpD,G;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oEAAoE,cAAc;;AAElF;AACA;AACA;AACA,EAAE;AACF;AACA,GAAG,2DAA2D;AAC9D;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI,oDAAoD;AACxD,IAAI;AACJ;AACA,EAAE;AACF;AACA;AACA,IAAI,qDAAqD;AACzD,IAAI,sDAAsD;AAC1D,IAAI;AACJ,aAAa,WAAW;AACxB,iBAAiB,sBAAsB;AACvC,WAAW,WAAW;AACtB,WAAW;AACX,KAAK;AACL,IAAI,4DAA4D;AAChE,IAAI;AACJ;AACA,EAAE;AACF;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH,EAAE;AACF;AACA;;AAEA;AACA,CAAC,EAAE,4DAA4D,EAAE,GAAG;AACpE,2CAA2C,cAAc;;;AAGzD;AACA,4B;;;;;;;;;;;;ACppBA;AAAA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEe,0EAAW,E;;;;;;;;;;;;AC7B1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAwC;AACa;AAC8C;;AAEnG;AACA;AACA,WAAW,EAAE;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,wEAAG;AACX;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,yBAAyB,wEAAG;AAC5B;AACA,QAAQ,wEAAG,uFAAuF,qDAAW;AAC7G,KAAK;AACL;AACA;AACA,kCAAkC,KAAK;AACvC;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,cAAc,eAAe;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,mBAAmB,8GAAQ;AAC3B,KAAK;AACL;AACA,mBAAmB,wEAAG;AACtB;AACA;AACA;AACe,sEAAO,E;;;;;;;;;;;;AC1DtB;AAAA;AAAA;AAAA;AAAgC","file":"main.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","// gif.js 0.2.0 - https://github.com/jnordberg/gif.js\n(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.GIF=f()}})(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){function EventEmitter(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined}module.exports=EventEmitter;EventEmitter.EventEmitter=EventEmitter;EventEmitter.prototype._events=undefined;EventEmitter.prototype._maxListeners=undefined;EventEmitter.defaultMaxListeners=10;EventEmitter.prototype.setMaxListeners=function(n){if(!isNumber(n)||n<0||isNaN(n))throw TypeError(\"n must be a positive number\");this._maxListeners=n;return this};EventEmitter.prototype.emit=function(type){var er,handler,len,args,i,listeners;if(!this._events)this._events={};if(type===\"error\"){if(!this._events.error||isObject(this._events.error)&&!this._events.error.length){er=arguments[1];if(er instanceof Error){throw er}else{var err=new Error('Uncaught, unspecified \"error\" event. ('+er+\")\");err.context=er;throw err}}}handler=this._events[type];if(isUndefined(handler))return false;if(isFunction(handler)){switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:args=Array.prototype.slice.call(arguments,1);handler.apply(this,args)}}else if(isObject(handler)){args=Array.prototype.slice.call(arguments,1);listeners=handler.slice();len=listeners.length;for(i=0;i<len;i++)listeners[i].apply(this,args)}return true};EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))throw TypeError(\"listener must be a function\");if(!this._events)this._events={};if(this._events.newListener)this.emit(\"newListener\",type,isFunction(listener.listener)?listener.listener:listener);if(!this._events[type])this._events[type]=listener;else if(isObject(this._events[type]))this._events[type].push(listener);else this._events[type]=[this._events[type],listener];if(isObject(this._events[type])&&!this._events[type].warned){if(!isUndefined(this._maxListeners)){m=this._maxListeners}else{m=EventEmitter.defaultMaxListeners}if(m&&m>0&&this._events[type].length>m){this._events[type].warned=true;console.error(\"(node) warning: possible EventEmitter memory \"+\"leak detected. %d listeners added. \"+\"Use emitter.setMaxListeners() to increase limit.\",this._events[type].length);if(typeof console.trace===\"function\"){console.trace()}}}return this};EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.once=function(type,listener){if(!isFunction(listener))throw TypeError(\"listener must be a function\");var fired=false;function g(){this.removeListener(type,g);if(!fired){fired=true;listener.apply(this,arguments)}}g.listener=listener;this.on(type,g);return this};EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))throw TypeError(\"listener must be a function\");if(!this._events||!this._events[type])return this;list=this._events[type];length=list.length;position=-1;if(list===listener||isFunction(list.listener)&&list.listener===listener){delete this._events[type];if(this._events.removeListener)this.emit(\"removeListener\",type,listener)}else if(isObject(list)){for(i=length;i-- >0;){if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}}if(position<0)return this;if(list.length===1){list.length=0;delete this._events[type]}else{list.splice(position,1)}if(this._events.removeListener)this.emit(\"removeListener\",type,listener)}return this};EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===0)this._events={};else if(this._events[type])delete this._events[type];return this}if(arguments.length===0){for(key in this._events){if(key===\"removeListener\")continue;this.removeAllListeners(key)}this.removeAllListeners(\"removeListener\");this._events={};return this}listeners=this._events[type];if(isFunction(listeners)){this.removeListener(type,listeners)}else if(listeners){while(listeners.length)this.removeListener(type,listeners[listeners.length-1])}delete this._events[type];return this};EventEmitter.prototype.listeners=function(type){var ret;if(!this._events||!this._events[type])ret=[];else if(isFunction(this._events[type]))ret=[this._events[type]];else ret=this._events[type].slice();return ret};EventEmitter.prototype.listenerCount=function(type){if(this._events){var evlistener=this._events[type];if(isFunction(evlistener))return 1;else if(evlistener)return evlistener.length}return 0};EventEmitter.listenerCount=function(emitter,type){return emitter.listenerCount(type)};function isFunction(arg){return typeof arg===\"function\"}function isNumber(arg){return typeof arg===\"number\"}function isObject(arg){return typeof arg===\"object\"&&arg!==null}function isUndefined(arg){return arg===void 0}},{}],2:[function(require,module,exports){var UA,browser,mode,platform,ua;ua=navigator.userAgent.toLowerCase();platform=navigator.platform.toLowerCase();UA=ua.match(/(opera|ie|firefox|chrome|version)[\\s\\/:]([\\w\\d\\.]+)?.*?(safari|version[\\s\\/:]([\\w\\d\\.]+)|$)/)||[null,\"unknown\",0];mode=UA[1]===\"ie\"&&document.documentMode;browser={name:UA[1]===\"version\"?UA[3]:UA[1],version:mode||parseFloat(UA[1]===\"opera\"&&UA[4]?UA[4]:UA[2]),platform:{name:ua.match(/ip(?:ad|od|hone)/)?\"ios\":(ua.match(/(?:webos|android)/)||platform.match(/mac|win|linux/)||[\"other\"])[0]}};browser[browser.name]=true;browser[browser.name+parseInt(browser.version,10)]=true;browser.platform[browser.platform.name]=true;module.exports=browser},{}],3:[function(require,module,exports){var EventEmitter,GIF,browser,extend=function(child,parent){for(var key in parent){if(hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},hasProp={}.hasOwnProperty,indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++){if(i in this&&this[i]===item)return i}return-1},slice=[].slice;EventEmitter=require(\"events\").EventEmitter;browser=require(\"./browser.coffee\");GIF=function(superClass){var defaults,frameDefaults;extend(GIF,superClass);defaults={workerScript:\"gif.worker.js\",workers:2,repeat:0,background:\"#fff\",quality:10,width:null,height:null,transparent:null,debug:false,dither:false};frameDefaults={delay:500,copy:false};function GIF(options){var base,key,value;this.running=false;this.options={};this.frames=[];this.freeWorkers=[];this.activeWorkers=[];this.setOptions(options);for(key in defaults){value=defaults[key];if((base=this.options)[key]==null){base[key]=value}}}GIF.prototype.setOption=function(key,value){this.options[key]=value;if(this._canvas!=null&&(key===\"width\"||key===\"height\")){return this._canvas[key]=value}};GIF.prototype.setOptions=function(options){var key,results,value;results=[];for(key in options){if(!hasProp.call(options,key))continue;value=options[key];results.push(this.setOption(key,value))}return results};GIF.prototype.addFrame=function(image,options){var frame,key;if(options==null){options={}}frame={};frame.transparent=this.options.transparent;for(key in frameDefaults){frame[key]=options[key]||frameDefaults[key]}if(this.options.width==null){this.setOption(\"width\",image.width)}if(this.options.height==null){this.setOption(\"height\",image.height)}if(typeof ImageData!==\"undefined\"&&ImageData!==null&&image instanceof ImageData){frame.data=image.data}else if(typeof CanvasRenderingContext2D!==\"undefined\"&&CanvasRenderingContext2D!==null&&image instanceof CanvasRenderingContext2D||typeof WebGLRenderingContext!==\"undefined\"&&WebGLRenderingContext!==null&&image instanceof WebGLRenderingContext){if(options.copy){frame.data=this.getContextData(image)}else{frame.context=image}}else if(image.childNodes!=null){if(options.copy){frame.data=this.getImageData(image)}else{frame.image=image}}else{throw new Error(\"Invalid image\")}return this.frames.push(frame)};GIF.prototype.render=function(){var i,j,numWorkers,ref;if(this.running){throw new Error(\"Already running\")}if(this.options.width==null||this.options.height==null){throw new Error(\"Width and height must be set prior to rendering\")}this.running=true;this.nextFrame=0;this.finishedFrames=0;this.imageParts=function(){var j,ref,results;results=[];for(i=j=0,ref=this.frames.length;0<=ref?j<ref:j>ref;i=0<=ref?++j:--j){results.push(null)}return results}.call(this);numWorkers=this.spawnWorkers();if(this.options.globalPalette===true){this.renderNextFrame()}else{for(i=j=0,ref=numWorkers;0<=ref?j<ref:j>ref;i=0<=ref?++j:--j){this.renderNextFrame()}}this.emit(\"start\");return this.emit(\"progress\",0)};GIF.prototype.abort=function(){var worker;while(true){worker=this.activeWorkers.shift();if(worker==null){break}this.log(\"killing active worker\");worker.terminate()}this.running=false;return this.emit(\"abort\")};GIF.prototype.spawnWorkers=function(){var j,numWorkers,ref,results;numWorkers=Math.min(this.options.workers,this.frames.length);(function(){results=[];for(var j=ref=this.freeWorkers.length;ref<=numWorkers?j<numWorkers:j>numWorkers;ref<=numWorkers?j++:j--){results.push(j)}return results}).apply(this).forEach(function(_this){return function(i){var worker;_this.log(\"spawning worker \"+i);worker=new Worker(_this.options.workerScript);worker.onmessage=function(event){_this.activeWorkers.splice(_this.activeWorkers.indexOf(worker),1);_this.freeWorkers.push(worker);return _this.frameFinished(event.data)};return _this.freeWorkers.push(worker)}}(this));return numWorkers};GIF.prototype.frameFinished=function(frame){var i,j,ref;this.log(\"frame \"+frame.index+\" finished - \"+this.activeWorkers.length+\" active\");this.finishedFrames++;this.emit(\"progress\",this.finishedFrames/this.frames.length);this.imageParts[frame.index]=frame;if(this.options.globalPalette===true){this.options.globalPalette=frame.globalPalette;this.log(\"global palette analyzed\");if(this.frames.length>2){for(i=j=1,ref=this.freeWorkers.length;1<=ref?j<ref:j>ref;i=1<=ref?++j:--j){this.renderNextFrame()}}}if(indexOf.call(this.imageParts,null)>=0){return this.renderNextFrame()}else{return this.finishRendering()}};GIF.prototype.finishRendering=function(){var data,frame,i,image,j,k,l,len,len1,len2,len3,offset,page,ref,ref1,ref2;len=0;ref=this.imageParts;for(j=0,len1=ref.length;j<len1;j++){frame=ref[j];len+=(frame.data.length-1)*frame.pageSize+frame.cursor}len+=frame.pageSize-frame.cursor;this.log(\"rendering finished - filesize \"+Math.round(len/1e3)+\"kb\");data=new Uint8Array(len);offset=0;ref1=this.imageParts;for(k=0,len2=ref1.length;k<len2;k++){frame=ref1[k];ref2=frame.data;for(i=l=0,len3=ref2.length;l<len3;i=++l){page=ref2[i];data.set(page,offset);if(i===frame.data.length-1){offset+=frame.cursor}else{offset+=frame.pageSize}}}image=new Blob([data],{type:\"image/gif\"});return this.emit(\"finished\",image,data)};GIF.prototype.renderNextFrame=function(){var frame,task,worker;if(this.freeWorkers.length===0){throw new Error(\"No free workers\")}if(this.nextFrame>=this.frames.length){return}frame=this.frames[this.nextFrame++];worker=this.freeWorkers.shift();task=this.getTask(frame);this.log(\"starting frame \"+(task.index+1)+\" of \"+this.frames.length);this.activeWorkers.push(worker);return worker.postMessage(task)};GIF.prototype.getContextData=function(ctx){return ctx.getImageData(0,0,this.options.width,this.options.height).data};GIF.prototype.getImageData=function(image){var ctx;if(this._canvas==null){this._canvas=document.createElement(\"canvas\");this._canvas.width=this.options.width;this._canvas.height=this.options.height}ctx=this._canvas.getContext(\"2d\");ctx.setFill=this.options.background;ctx.fillRect(0,0,this.options.width,this.options.height);ctx.drawImage(image,0,0);return this.getContextData(ctx)};GIF.prototype.getTask=function(frame){var index,task;index=this.frames.indexOf(frame);task={index:index,last:index===this.frames.length-1,delay:frame.delay,transparent:frame.transparent,width:this.options.width,height:this.options.height,quality:this.options.quality,dither:this.options.dither,globalPalette:this.options.globalPalette,repeat:this.options.repeat,canTransfer:browser.name===\"chrome\"};if(frame.data!=null){task.data=frame.data}else if(frame.context!=null){task.data=this.getContextData(frame.context)}else if(frame.image!=null){task.data=this.getImageData(frame.image)}else{throw new Error(\"Invalid frame\")};return task};GIF.prototype.log=function(){var args;args=1<=arguments.length?slice.call(arguments,0):[];if(!this.options.debug){return}return console.log.apply(console,args)};return GIF}(EventEmitter);module.exports=GIF},{\"./browser.coffee\":2,events:1}]},{},[3])(3)});\n//# sourceMappingURL=gif.js.map\n","(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n\n// Stream object for reading off bytes from a byte array\n\nfunction ByteStream(data){\n\tthis.data = data;\n\tthis.pos = 0;\n}\n\n// read the next byte off the stream\nByteStream.prototype.readByte = function(){\n\treturn this.data[this.pos++];\n};\n\n// look at the next byte in the stream without updating the stream position\nByteStream.prototype.peekByte = function(){\n\treturn this.data[this.pos];\n};\n\n// read an array of bytes\nByteStream.prototype.readBytes = function(n){\n\tvar bytes = new Array(n);\n\tfor(var i=0; i<n; i++){\n\t\tbytes[i] = this.readByte();\n\t}\n\treturn bytes;\n};\n\n// peek at an array of bytes without updating the stream position\nByteStream.prototype.peekBytes = function(n){\n\tvar bytes = new Array(n);\n\tfor(var i=0; i<n; i++){\n\t\tbytes[i] = this.data[this.pos + i];\n\t}\n\treturn bytes;\n};\n\n// read a string from a byte set\nByteStream.prototype.readString = function(len){\n\tvar str = '';\n\tfor(var i=0; i<len; i++){\n\t\tstr += String.fromCharCode(this.readByte());\n\t}\n\treturn str;\n};\n\n// read a single byte and return an array of bit booleans\nByteStream.prototype.readBitArray = function(){\n\tvar arr = [];\n\tvar bite = this.readByte();\n\tfor (var i = 7; i >= 0; i--) {\n\t\tarr.push(!!(bite & (1 << i)));\n\t}\n\treturn arr;\n};\n\n// read an unsigned int with endian option\nByteStream.prototype.readUnsigned = function(littleEndian){\n\tvar a = this.readBytes(2);\n\tif(littleEndian){\n\t\treturn (a[1] << 8) + a[0];\t\n\t}else{\n\t\treturn (a[0] << 8) + a[1];\n\t}\t\n};\n\nmodule.exports = ByteStream;\n},{}],2:[function(require,module,exports){\n\n// Primary data parsing object used to parse byte arrays\n\nvar ByteStream = require('./bytestream');\n\nfunction DataParser(data){\n\tthis.stream = new ByteStream(data);\n\t// the final parsed object from the data\n\tthis.output = {};\n}\n\nDataParser.prototype.parse = function(schema){\n\t// the top level schema is just the top level parts array\n\tthis.parseParts(this.output, schema);\t\n\treturn this.output;\n};\n\n// parse a set of hierarchy parts providing the parent object, and the subschema\nDataParser.prototype.parseParts = function(obj, schema){\n\tfor(var i=0; i<schema.length; i++){\n\t\tvar part = schema[i];\n\t\tthis.parsePart(obj, part); \n\t}\n};\n\nDataParser.prototype.parsePart = function(obj, part){\n\tvar name = part.label;\n\tvar value;\n\n\t// make sure the part meets any parse requirements\n\tif(part.requires && ! part.requires(this.stream, this.output, obj)){\n\t\treturn;\n\t}\n\t\n\tif(part.loop){\n\t\t// create a parse loop over the parts\n\t\tvar items = [];\n\t\twhile(part.loop(this.stream)){\n\t\t\tvar item = {};\n\t\t\tthis.parseParts(item, part.parts);\n\t\t\titems.push(item);\n\t\t}\n\t\tobj[name] = items;\n\t}else if(part.parts){\n\t\t// process any child parts\n\t\tvalue = {};\n\t\tthis.parseParts(value, part.parts);\n\t\tobj[name] = value;\n\t}else if(part.parser){\n\t\t// parse the value using a parser\n\t\tvalue = part.parser(this.stream, this.output, obj);\n\t\tif(!part.skip){\n\t\t\tobj[name] = value;\n\t\t}\n\t}else if(part.bits){\n\t\t// convert the next byte to a set of bit fields\n\t\tobj[name] = this.parseBits(part.bits);\n\t}\n};\n\n// combine bits to calculate value\nfunction bitsToNum(bitArray){\n\treturn bitArray.reduce(function(s, n) { return s * 2 + n; }, 0);\n}\n\n// parse a byte as a bit set (flags and values)\nDataParser.prototype.parseBits = function(details){\n\tvar out = {};\n\tvar bits = this.stream.readBitArray();\n\tfor(var key in details){\n\t\tvar item = details[key];\n\t\tif(item.length){\n\t\t\t// convert the bit set to value\n\t\t\tout[key] = bitsToNum(bits.slice(item.index, item.index + item.length));\n\t\t}else{\n\t\t\tout[key] = bits[item.index];\n\t\t}\n\t}\n\treturn out;\n};\n\nmodule.exports = DataParser;\n},{\"./bytestream\":1}],3:[function(require,module,exports){\n\n// a set of common parsers used with DataParser\n\nvar Parsers = {\n\t// read a byte\n\treadByte: function(){\n\t\treturn function(stream){\n\t\t\treturn stream.readByte();\n\t\t};\n\t},\n\t// read an array of bytes\n\treadBytes: function(length){\n\t\treturn function(stream){\n\t\t\treturn stream.readBytes(length);\n\t\t};\n\t},\n\t// read a string from bytes\n\treadString: function(length){\n\t\treturn function(stream){\n\t\t\treturn stream.readString(length);\n\t\t};\n\t},\n\t// read an unsigned int (with endian)\n\treadUnsigned: function(littleEndian){\n\t\treturn function(stream){\n\t\t\treturn stream.readUnsigned(littleEndian);\n\t\t};\n\t},\n\t// read an array of byte sets\n\treadArray: function(size, countFunc){\n\t\treturn function(stream, obj, parent){\n\t\t\tvar count = countFunc(stream, obj, parent);\n\t\t\tvar arr = new Array(count);\n\t\t\tfor(var i=0; i<count; i++){\n\t\t\t\tarr[i] = stream.readBytes(size);\n\t\t\t}\n\t\t\treturn arr;\n\t\t};\n\t}\n};\n\nmodule.exports = Parsers;\n},{}],4:[function(require,module,exports){\n// export wrapper for exposing library\n\nvar GIF = window.GIF || {};\n\nGIF = require('./gif');\n\nwindow.GIF = GIF;\n},{\"./gif\":5}],5:[function(require,module,exports){\n\n// object used to represent array buffer data for a gif file\n\nvar DataParser = require('../bower_components/js-binary-schema-parser/src/dataparser');\nvar gifSchema = require('./schema');\n\nfunction GIF(arrayBuffer){\n\t// convert to byte array\n\tvar byteData = new Uint8Array(arrayBuffer);\n\tvar parser = new DataParser(byteData);\n\t// parse the data\n\tthis.raw = parser.parse(gifSchema);\n\n\t// set a flag to make sure the gif contains at least one image\n\tthis.raw.hasImages = false;\n\tfor(var f=0; f<this.raw.frames.length; f++){\n\t\tif(this.raw.frames[f].image){\n\t\t\tthis.raw.hasImages = true;\n\t\t\tbreak;\n\t\t}\n\t}\n}\n\n// process a single gif image frames data, decompressing it using LZW \n// if buildPatch is true, the returned image will be a clamped 8 bit image patch\n// for use directly with a canvas.\nGIF.prototype.decompressFrame = function(index, buildPatch){\n\n\t// make sure a valid frame is requested\n\tif(index >= this.raw.frames.length){ return null; }\n\n\tvar frame = this.raw.frames[index];\n\tif(frame.image){\n\t\t// get the number of pixels\n\t\tvar totalPixels = frame.image.descriptor.width * frame.image.descriptor.height;\n\n\t\t// do lzw decompression\n\t\tvar pixels = lzw(frame.image.data.minCodeSize, frame.image.data.blocks, totalPixels);\n\n\t\t// deal with interlacing if necessary\n\t\tif(frame.image.descriptor.lct.interlaced){\n\t\t\tpixels = deinterlace(pixels, frame.image.descriptor.width);\n\t\t}\n\n\t\t// setup usable image object\n\t\tvar image = {\n\t\t\tpixels: pixels,\n\t\t\tdims: {\n\t\t\t\ttop: frame.image.descriptor.top,\n\t\t\t\tleft: frame.image.descriptor.left,\n\t\t\t\twidth: frame.image.descriptor.width,\n\t\t\t\theight: frame.image.descriptor.height\n\t\t\t}\n\t\t};\n\n\t\t// color table\n\t\tif(frame.image.descriptor.lct && frame.image.descriptor.lct.exists){\n\t\t\timage.colorTable = frame.image.lct;\n\t\t}else{\n\t\t\timage.colorTable = this.raw.gct;\n\t\t}\n\n\t\t// add per frame relevant gce information\n\t\tif(frame.gce){\n\t\t\timage.delay = (frame.gce.delay || 10) * 10; // convert to ms\n\t\t\timage.disposalType = frame.gce.extras.disposal;\n\t\t\t// transparency\n\t\t\tif(frame.gce.extras.transparentColorGiven){\n\t\t\t\timage.transparentIndex = frame.gce.transparentColorIndex;\n\t\t\t}\n\t\t}\n\n\t\t// create canvas usable imagedata if desired\n\t\tif(buildPatch){\n\t\t\timage.patch = generatePatch(image);\n\t\t}\n\n\t\treturn image;\t\t\n\t}\n\n\t// frame does not contains image\n\treturn null;\n\n\n\t/**\n\t * javascript port of java LZW decompression\n\t * Original java author url: https://gist.github.com/devunwired/4479231\n\t */\t\n\tfunction lzw(minCodeSize, data, pixelCount) {\n \t\t\n \t\tvar MAX_STACK_SIZE = 4096;\n\t\tvar nullCode = -1;\n\n\t\tvar npix = pixelCount;\n\t\tvar available, clear, code_mask, code_size, end_of_information, in_code, old_code, bits, code, i, datum, data_size, first, top, bi, pi;\n \n \t\tvar dstPixels = new Array(pixelCount);\n\t\tvar prefix = new Array(MAX_STACK_SIZE);\n\t\tvar suffix = new Array(MAX_STACK_SIZE);\n\t\tvar pixelStack = new Array(MAX_STACK_SIZE + 1);\n \n\t\t// Initialize GIF data stream decoder.\n\t\tdata_size = minCodeSize;\n\t\tclear = 1 << data_size;\n\t\tend_of_information = clear + 1;\n\t\tavailable = clear + 2;\n\t\told_code = nullCode;\n\t\tcode_size = data_size + 1;\n\t\tcode_mask = (1 << code_size) - 1;\n\t\tfor (code = 0; code < clear; code++) {\n\t\t\tprefix[code] = 0;\n\t\t\tsuffix[code] = code;\n\t\t}\n \n\t\t// Decode GIF pixel stream.\n\t\tdatum = bits = count = first = top = pi = bi = 0;\n\t\tfor (i = 0; i < npix; ) {\n\t\t\tif (top === 0) {\n\t\t\t\tif (bits < code_size) {\n\t\t\t\t\t\n\t\t\t\t\t// get the next byte\t\t\t\n\t\t\t\t\tdatum += data[bi] << bits;\n\n\t\t\t\t\tbits += 8;\n\t\t\t\t\tbi++;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\t// Get the next code.\n\t\t\t\tcode = datum & code_mask;\n\t\t\t\tdatum >>= code_size;\n\t\t\t\tbits -= code_size;\n\t\t\t\t// Interpret the code\n\t\t\t\tif ((code > available) || (code == end_of_information)) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (code == clear) {\n\t\t\t\t\t// Reset decoder.\n\t\t\t\t\tcode_size = data_size + 1;\n\t\t\t\t\tcode_mask = (1 << code_size) - 1;\n\t\t\t\t\tavailable = clear + 2;\n\t\t\t\t\told_code = nullCode;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (old_code == nullCode) {\n\t\t\t\t\tpixelStack[top++] = suffix[code];\n\t\t\t\t\told_code = code;\n\t\t\t\t\tfirst = code;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tin_code = code;\n\t\t\t\tif (code == available) {\n\t\t\t\t\tpixelStack[top++] = first;\n\t\t\t\t\tcode = old_code;\n\t\t\t\t}\n\t\t\t\twhile (code > clear) {\n\t\t\t\t\tpixelStack[top++] = suffix[code];\n\t\t\t\t\tcode = prefix[code];\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfirst = suffix[code] & 0xff;\n\t\t\t\tpixelStack[top++] = first;\n\n\t\t\t\t// add a new string to the table, but only if space is available\n\t\t\t\t// if not, just continue with current table until a clear code is found\n\t\t\t\t// (deferred clear code implementation as per GIF spec)\n\t\t\t\tif(available < MAX_STACK_SIZE){\n\t\t\t\t\tprefix[available] = old_code;\n\t\t\t\t\tsuffix[available] = first;\n\t\t\t\t\tavailable++;\n\t\t\t\t\tif (((available & code_mask) === 0) && (available < MAX_STACK_SIZE)) {\n\t\t\t\t\t\tcode_size++;\n\t\t\t\t\t\tcode_mask += available;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\told_code = in_code;\n\t\t\t}\n\t\t\t// Pop a pixel off the pixel stack.\n\t\t\ttop--;\n\t\t\tdstPixels[pi++] = pixelStack[top];\n\t\t\ti++;\n\t\t}\n\n\t\tfor (i = pi; i < npix; i++) {\n\t\t\tdstPixels[i] = 0; // clear missing pixels\n\t\t}\n\n\t\treturn dstPixels;\n\t}\n\n\t// deinterlace function from https://github.com/shachaf/jsgif\n\tfunction deinterlace(pixels, width) {\n\t\t\n\t\tvar newPixels = new Array(pixels.length);\n\t\tvar rows = pixels.length / width;\n\t\tvar cpRow = function(toRow, fromRow) {\n\t\t\tvar fromPixels = pixels.slice(fromRow * width, (fromRow + 1) * width);\n\t\t\tnewPixels.splice.apply(newPixels, [toRow * width, width].concat(fromPixels));\n\t\t};\n\n\t\t// See appendix E.\n\t\tvar offsets = [0,4,2,1];\n\t\tvar steps   = [8,8,4,2];\n\n\t\tvar fromRow = 0;\n\t\tfor (var pass = 0; pass < 4; pass++) {\n\t\t\tfor (var toRow = offsets[pass]; toRow < rows; toRow += steps[pass]) {\n\t\t\t\tcpRow(toRow, fromRow);\n\t\t\t\tfromRow++;\n\t\t\t}\n\t\t}\n\n\t\treturn newPixels;\n\t}\n\n\t// create a clamped byte array patch for the frame image to be used directly with a canvas\n\t// TODO: could potentially squeeze some performance by doing a direct 32bit write per iteration\n\tfunction generatePatch(image){\n\n\t\tvar totalPixels = image.pixels.length;\n\t\tvar patchData = new Uint8ClampedArray(totalPixels * 4);\n\t\tfor(var i=0; i<totalPixels; i++){\n\t\t\tvar pos = i * 4;\n\t\t\tvar colorIndex = image.pixels[i];\n\t\t\tvar color = image.colorTable[colorIndex];\n\t\t\tpatchData[pos] = color[0];\n\t\t\tpatchData[pos + 1] = color[1];\n\t\t\tpatchData[pos + 2] = color[2];\n\t\t\tpatchData[pos + 3] = colorIndex !== image.transparentIndex ? 255 : 0;\n\t\t}\n\n\t\treturn patchData;\n\t}\n};\n\n// returns all frames decompressed\nGIF.prototype.decompressFrames = function(buildPatch){\n\tvar frames = [];\n\tfor(var i=0; i<this.raw.frames.length; i++){\n\t\tvar frame = this.raw.frames[i];\n\t\tif(frame.image){\n\t\t\tframes.push(this.decompressFrame(i, buildPatch));\n\t\t}\n\t}\n\treturn frames;\n};\n\nmodule.exports = GIF;\n},{\"../bower_components/js-binary-schema-parser/src/dataparser\":2,\"./schema\":6}],6:[function(require,module,exports){\n\n// Schema for the js file parser to use to parse gif files\n// For js object convenience (re-use), the schema objects are approximately reverse ordered\n\n// common parsers available\nvar Parsers = require('../bower_components/js-binary-schema-parser/src/parsers');\n\n// a set of 0x00 terminated subblocks\nvar subBlocks = {\n\tlabel: 'blocks',\n\tparser: function(stream){\n\t\tvar out = [];\n\t\tvar terminator = 0x00;\t\t\n\t\tfor(var size=stream.readByte(); size!==terminator; size=stream.readByte()){\n\t\t\tout = out.concat(stream.readBytes(size));\n\t\t}\n\t\treturn out;\n\t}\n};\n\n// global control extension\nvar gce = {\n\tlabel: 'gce',\n\trequires: function(stream){\n\t\t// just peek at the top two bytes, and if true do this\n\t\tvar codes = stream.peekBytes(2);\n\t\treturn codes[0] === 0x21 && codes[1] === 0xF9;\n\t},\n\tparts: [\n\t\t{ label: 'codes', parser: Parsers.readBytes(2), skip: true },\n\t\t{ label: 'byteSize', parser: Parsers.readByte() },\n\t\t{ label: 'extras', bits: {\n\t\t\tfuture: { index: 0, length: 3 },\n\t\t\tdisposal: { index: 3, length: 3 },\n\t\t\tuserInput: { index: 6 },\n\t\t\ttransparentColorGiven: { index: 7 }\n\t\t}},\n\t\t{ label: 'delay', parser: Parsers.readUnsigned(true) },\n\t\t{ label: 'transparentColorIndex', parser: Parsers.readByte() },\n\t\t{ label: 'terminator', parser: Parsers.readByte(), skip: true }\n\t]\n};\n\n// image pipeline block\nvar image = {\n\tlabel: 'image',\n\trequires: function(stream){\n\t\t// peek at the next byte\n\t\tvar code = stream.peekByte();\n\t\treturn code === 0x2C;\n\t},\n\tparts: [\n\t\t{ label: 'code', parser: Parsers.readByte(), skip: true },\n\t\t{\n\t\t\tlabel: 'descriptor', // image descriptor\n\t\t\tparts: [\n\t\t\t\t{ label: 'left', parser: Parsers.readUnsigned(true) },\n\t\t\t\t{ label: 'top', parser: Parsers.readUnsigned(true) },\n\t\t\t\t{ label: 'width', parser: Parsers.readUnsigned(true) },\n\t\t\t\t{ label: 'height', parser: Parsers.readUnsigned(true) },\n\t\t\t\t{ label: 'lct', bits: {\n\t\t\t\t\texists: { index: 0 },\n\t\t\t\t\tinterlaced: { index: 1 },\n\t\t\t\t\tsort: { index: 2 },\n\t\t\t\t\tfuture: { index: 3, length: 2 },\n\t\t\t\t\tsize: { index: 5, length: 3 }\n\t\t\t\t}}\n\t\t\t]\n\t\t},{\n\t\t\tlabel: 'lct', // optional local color table\n\t\t\trequires: function(stream, obj, parent){\n\t\t\t\treturn parent.descriptor.lct.exists;\n\t\t\t},\n\t\t\tparser: Parsers.readArray(3, function(stream, obj, parent){\n\t\t\t\treturn Math.pow(2, parent.descriptor.lct.size + 1);\n\t\t\t})\n\t\t},{\n\t\t\tlabel: 'data', // the image data blocks\n\t\t\tparts: [\n\t\t\t\t{ label: 'minCodeSize', parser: Parsers.readByte() },\n\t\t\t\tsubBlocks\n\t\t\t]\n\t\t}\n\t]\n};\n\n// plain text block\nvar text = {\n\tlabel: 'text',\n\trequires: function(stream){\n\t\t// just peek at the top two bytes, and if true do this\n\t\tvar codes = stream.peekBytes(2);\n\t\treturn codes[0] === 0x21 && codes[1] === 0x01;\n\t},\n\tparts: [\n\t\t{ label: 'codes', parser: Parsers.readBytes(2), skip: true },\n\t\t{ label: 'blockSize', parser: Parsers.readByte() },\n\t\t{ \n\t\t\tlabel: 'preData', \n\t\t\tparser: function(stream, obj, parent){\n\t\t\t\treturn stream.readBytes(parent.text.blockSize);\n\t\t\t}\n\t\t},\n\t\tsubBlocks\n\t]\n};\n\n// application block\nvar application = {\n\tlabel: 'application',\n\trequires: function(stream, obj, parent){\n\t\t// make sure this frame doesn't already have a gce, text, comment, or image\n\t\t// as that means this block should be attached to the next frame\n\t\t//if(parent.gce || parent.text || parent.image || parent.comment){ return false; }\n\n\t\t// peek at the top two bytes\n\t\tvar codes = stream.peekBytes(2);\n\t\treturn codes[0] === 0x21 && codes[1] === 0xFF;\n\t},\n\tparts: [\n\t\t{ label: 'codes', parser: Parsers.readBytes(2), skip: true },\n\t\t{ label: 'blockSize', parser: Parsers.readByte() },\n\t\t{ \n\t\t\tlabel: 'id', \n\t\t\tparser: function(stream, obj, parent){\n\t\t\t\treturn stream.readString(parent.blockSize);\n\t\t\t}\n\t\t},\n\t\tsubBlocks\n\t]\n};\n\n// comment block\nvar comment = {\n\tlabel: 'comment',\n\trequires: function(stream, obj, parent){\n\t\t// make sure this frame doesn't already have a gce, text, comment, or image\n\t\t// as that means this block should be attached to the next frame\n\t\t//if(parent.gce || parent.text || parent.image || parent.comment){ return false; }\n\n\t\t// peek at the top two bytes\n\t\tvar codes = stream.peekBytes(2);\n\t\treturn codes[0] === 0x21 && codes[1] === 0xFE;\n\t},\n\tparts: [\n\t\t{ label: 'codes', parser: Parsers.readBytes(2), skip: true },\n\t\tsubBlocks\n\t]\n};\n\n// frames of ext and image data\nvar frames = {\n\tlabel: 'frames',\n\tparts: [\n\t\tgce,\n\t\tapplication,\n\t\tcomment,\n\t\timage,\n\t\ttext\n\t],\n\tloop: function(stream){\n\t\tvar nextCode = stream.peekByte();\n\t\t// rather than check for a terminator, we should check for the existence\n\t\t// of an ext or image block to avoid infinite loops\n\t\t//var terminator = 0x3B;\n\t\t//return nextCode !== terminator;\n\t\treturn nextCode === 0x21 || nextCode === 0x2C;\n\t}\n};\n\n// main GIF schema\nvar schemaGIF = [\n\t{\n\t\tlabel: 'header', // gif header\n\t\tparts: [\n\t\t\t{ label: 'signature', parser: Parsers.readString(3) },\n\t\t\t{ label: 'version', parser: Parsers.readString(3) }\n\t\t]\n\t},{\n\t\tlabel: 'lsd', // local screen descriptor\n\t\tparts: [\n\t\t\t{ label: 'width', parser: Parsers.readUnsigned(true) },\n\t\t\t{ label: 'height', parser: Parsers.readUnsigned(true) },\n\t\t\t{ label: 'gct', bits: {\n\t\t\t\texists: { index: 0 },\n\t\t\t\tresolution: { index: 1, length: 3 },\n\t\t\t\tsort: { index: 4 },\n\t\t\t\tsize: { index: 5, length: 3 }\n\t\t\t}},\n\t\t\t{ label: 'backgroundColorIndex', parser: Parsers.readByte() },\n\t\t\t{ label: 'pixelAspectRatio', parser: Parsers.readByte() }\n\t\t]\n\t},{\n\t\tlabel: 'gct', // global color table\n\t\trequires: function(stream, obj){\n\t\t\treturn obj.lsd.gct.exists;\n\t\t},\n\t\tparser: Parsers.readArray(3, function(stream, obj){\n\t\t\treturn Math.pow(2, obj.lsd.gct.size + 1);\n\t\t})\n\t},\n\tframes // content frames\n];\n\nmodule.exports = schemaGIF;\n},{\"../bower_components/js-binary-schema-parser/src/parsers\":3}]},{},[4])\n//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJib3dlcl9jb21wb25lbnRzL2pzLWJpbmFyeS1zY2hlbWEtcGFyc2VyL3NyYy9ieXRlc3RyZWFtLmpzIiwiYm93ZXJfY29tcG9uZW50cy9qcy1iaW5hcnktc2NoZW1hLXBhcnNlci9zcmMvZGF0YXBhcnNlci5qcyIsImJvd2VyX2NvbXBvbmVudHMvanMtYmluYXJ5LXNjaGVtYS1wYXJzZXIvc3JjL3BhcnNlcnMuanMiLCJzcmMvZXhwb3J0cy5qcyIsInNyYy9naWYuanMiLCJzcmMvc2NoZW1hLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0UEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiXG4vLyBTdHJlYW0gb2JqZWN0IGZvciByZWFkaW5nIG9mZiBieXRlcyBmcm9tIGEgYnl0ZSBhcnJheVxuXG5mdW5jdGlvbiBCeXRlU3RyZWFtKGRhdGEpe1xuXHR0aGlzLmRhdGEgPSBkYXRhO1xuXHR0aGlzLnBvcyA9IDA7XG59XG5cbi8vIHJlYWQgdGhlIG5leHQgYnl0ZSBvZmYgdGhlIHN0cmVhbVxuQnl0ZVN0cmVhbS5wcm90b3R5cGUucmVhZEJ5dGUgPSBmdW5jdGlvbigpe1xuXHRyZXR1cm4gdGhpcy5kYXRhW3RoaXMucG9zKytdO1xufTtcblxuLy8gbG9vayBhdCB0aGUgbmV4dCBieXRlIGluIHRoZSBzdHJlYW0gd2l0aG91dCB1cGRhdGluZyB0aGUgc3RyZWFtIHBvc2l0aW9uXG5CeXRlU3RyZWFtLnByb3RvdHlwZS5wZWVrQnl0ZSA9IGZ1bmN0aW9uKCl7XG5cdHJldHVybiB0aGlzLmRhdGFbdGhpcy5wb3NdO1xufTtcblxuLy8gcmVhZCBhbiBhcnJheSBvZiBieXRlc1xuQnl0ZVN0cmVhbS5wcm90b3R5cGUucmVhZEJ5dGVzID0gZnVuY3Rpb24obil7XG5cdHZhciBieXRlcyA9IG5ldyBBcnJheShuKTtcblx0Zm9yKHZhciBpPTA7IGk8bjsgaSsrKXtcblx0XHRieXRlc1tpXSA9IHRoaXMucmVhZEJ5dGUoKTtcblx0fVxuXHRyZXR1cm4gYnl0ZXM7XG59O1xuXG4vLyBwZWVrIGF0IGFuIGFycmF5IG9mIGJ5dGVzIHdpdGhvdXQgdXBkYXRpbmcgdGhlIHN0cmVhbSBwb3NpdGlvblxuQnl0ZVN0cmVhbS5wcm90b3R5cGUucGVla0J5dGVzID0gZnVuY3Rpb24obil7XG5cdHZhciBieXRlcyA9IG5ldyBBcnJheShuKTtcblx0Zm9yKHZhciBpPTA7IGk8bjsgaSsrKXtcblx0XHRieXRlc1tpXSA9IHRoaXMuZGF0YVt0aGlzLnBvcyArIGldO1xuXHR9XG5cdHJldHVybiBieXRlcztcbn07XG5cbi8vIHJlYWQgYSBzdHJpbmcgZnJvbSBhIGJ5dGUgc2V0XG5CeXRlU3RyZWFtLnByb3RvdHlwZS5yZWFkU3RyaW5nID0gZnVuY3Rpb24obGVuKXtcblx0dmFyIHN0ciA9ICcnO1xuXHRmb3IodmFyIGk9MDsgaTxsZW47IGkrKyl7XG5cdFx0c3RyICs9IFN0cmluZy5mcm9tQ2hhckNvZGUodGhpcy5yZWFkQnl0ZSgpKTtcblx0fVxuXHRyZXR1cm4gc3RyO1xufTtcblxuLy8gcmVhZCBhIHNpbmdsZSBieXRlIGFuZCByZXR1cm4gYW4gYXJyYXkgb2YgYml0IGJvb2xlYW5zXG5CeXRlU3RyZWFtLnByb3RvdHlwZS5yZWFkQml0QXJyYXkgPSBmdW5jdGlvbigpe1xuXHR2YXIgYXJyID0gW107XG5cdHZhciBiaXRlID0gdGhpcy5yZWFkQnl0ZSgpO1xuXHRmb3IgKHZhciBpID0gNzsgaSA+PSAwOyBpLS0pIHtcblx0XHRhcnIucHVzaCghIShiaXRlICYgKDEgPDwgaSkpKTtcblx0fVxuXHRyZXR1cm4gYXJyO1xufTtcblxuLy8gcmVhZCBhbiB1bnNpZ25lZCBpbnQgd2l0aCBlbmRpYW4gb3B0aW9uXG5CeXRlU3RyZWFtLnByb3RvdHlwZS5yZWFkVW5zaWduZWQgPSBmdW5jdGlvbihsaXR0bGVFbmRpYW4pe1xuXHR2YXIgYSA9IHRoaXMucmVhZEJ5dGVzKDIpO1xuXHRpZihsaXR0bGVFbmRpYW4pe1xuXHRcdHJldHVybiAoYVsxXSA8PCA4KSArIGFbMF07XHRcblx0fWVsc2V7XG5cdFx0cmV0dXJuIChhWzBdIDw8IDgpICsgYVsxXTtcblx0fVx0XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEJ5dGVTdHJlYW07IiwiXG4vLyBQcmltYXJ5IGRhdGEgcGFyc2luZyBvYmplY3QgdXNlZCB0byBwYXJzZSBieXRlIGFycmF5c1xuXG52YXIgQnl0ZVN0cmVhbSA9IHJlcXVpcmUoJy4vYnl0ZXN0cmVhbScpO1xuXG5mdW5jdGlvbiBEYXRhUGFyc2VyKGRhdGEpe1xuXHR0aGlzLnN0cmVhbSA9IG5ldyBCeXRlU3RyZWFtKGRhdGEpO1xuXHQvLyB0aGUgZmluYWwgcGFyc2VkIG9iamVjdCBmcm9tIHRoZSBkYXRhXG5cdHRoaXMub3V0cHV0ID0ge307XG59XG5cbkRhdGFQYXJzZXIucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24oc2NoZW1hKXtcblx0Ly8gdGhlIHRvcCBsZXZlbCBzY2hlbWEgaXMganVzdCB0aGUgdG9wIGxldmVsIHBhcnRzIGFycmF5XG5cdHRoaXMucGFyc2VQYXJ0cyh0aGlzLm91dHB1dCwgc2NoZW1hKTtcdFxuXHRyZXR1cm4gdGhpcy5vdXRwdXQ7XG59O1xuXG4vLyBwYXJzZSBhIHNldCBvZiBoaWVyYXJjaHkgcGFydHMgcHJvdmlkaW5nIHRoZSBwYXJlbnQgb2JqZWN0LCBhbmQgdGhlIHN1YnNjaGVtYVxuRGF0YVBhcnNlci5wcm90b3R5cGUucGFyc2VQYXJ0cyA9IGZ1bmN0aW9uKG9iaiwgc2NoZW1hKXtcblx0Zm9yKHZhciBpPTA7IGk8c2NoZW1hLmxlbmd0aDsgaSsrKXtcblx0XHR2YXIgcGFydCA9IHNjaGVtYVtpXTtcblx0XHR0aGlzLnBhcnNlUGFydChvYmosIHBhcnQpOyBcblx0fVxufTtcblxuRGF0YVBhcnNlci5wcm90b3R5cGUucGFyc2VQYXJ0ID0gZnVuY3Rpb24ob2JqLCBwYXJ0KXtcblx0dmFyIG5hbWUgPSBwYXJ0LmxhYmVsO1xuXHR2YXIgdmFsdWU7XG5cblx0Ly8gbWFrZSBzdXJlIHRoZSBwYXJ0IG1lZXRzIGFueSBwYXJzZSByZXF1aXJlbWVudHNcblx0aWYocGFydC5yZXF1aXJlcyAmJiAhIHBhcnQucmVxdWlyZXModGhpcy5zdHJlYW0sIHRoaXMub3V0cHV0LCBvYmopKXtcblx0XHRyZXR1cm47XG5cdH1cblx0XG5cdGlmKHBhcnQubG9vcCl7XG5cdFx0Ly8gY3JlYXRlIGEgcGFyc2UgbG9vcCBvdmVyIHRoZSBwYXJ0c1xuXHRcdHZhciBpdGVtcyA9IFtdO1xuXHRcdHdoaWxlKHBhcnQubG9vcCh0aGlzLnN0cmVhbSkpe1xuXHRcdFx0dmFyIGl0ZW0gPSB7fTtcblx0XHRcdHRoaXMucGFyc2VQYXJ0cyhpdGVtLCBwYXJ0LnBhcnRzKTtcblx0XHRcdGl0ZW1zLnB1c2goaXRlbSk7XG5cdFx0fVxuXHRcdG9ialtuYW1lXSA9IGl0ZW1zO1xuXHR9ZWxzZSBpZihwYXJ0LnBhcnRzKXtcblx0XHQvLyBwcm9jZXNzIGFueSBjaGlsZCBwYXJ0c1xuXHRcdHZhbHVlID0ge307XG5cdFx0dGhpcy5wYXJzZVBhcnRzKHZhbHVlLCBwYXJ0LnBhcnRzKTtcblx0XHRvYmpbbmFtZV0gPSB2YWx1ZTtcblx0fWVsc2UgaWYocGFydC5wYXJzZXIpe1xuXHRcdC8vIHBhcnNlIHRoZSB2YWx1ZSB1c2luZyBhIHBhcnNlclxuXHRcdHZhbHVlID0gcGFydC5wYXJzZXIodGhpcy5zdHJlYW0sIHRoaXMub3V0cHV0LCBvYmopO1xuXHRcdGlmKCFwYXJ0LnNraXApe1xuXHRcdFx0b2JqW25hbWVdID0gdmFsdWU7XG5cdFx0fVxuXHR9ZWxzZSBpZihwYXJ0LmJpdHMpe1xuXHRcdC8vIGNvbnZlcnQgdGhlIG5leHQgYnl0ZSB0byBhIHNldCBvZiBiaXQgZmllbGRzXG5cdFx0b2JqW25hbWVdID0gdGhpcy5wYXJzZUJpdHMocGFydC5iaXRzKTtcblx0fVxufTtcblxuLy8gY29tYmluZSBiaXRzIHRvIGNhbGN1bGF0ZSB2YWx1ZVxuZnVuY3Rpb24gYml0c1RvTnVtKGJpdEFycmF5KXtcblx0cmV0dXJuIGJpdEFycmF5LnJlZHVjZShmdW5jdGlvbihzLCBuKSB7IHJldHVybiBzICogMiArIG47IH0sIDApO1xufVxuXG4vLyBwYXJzZSBhIGJ5dGUgYXMgYSBiaXQgc2V0IChmbGFncyBhbmQgdmFsdWVzKVxuRGF0YVBhcnNlci5wcm90b3R5cGUucGFyc2VCaXRzID0gZnVuY3Rpb24oZGV0YWlscyl7XG5cdHZhciBvdXQgPSB7fTtcblx0dmFyIGJpdHMgPSB0aGlzLnN0cmVhbS5yZWFkQml0QXJyYXkoKTtcblx0Zm9yKHZhciBrZXkgaW4gZGV0YWlscyl7XG5cdFx0dmFyIGl0ZW0gPSBkZXRhaWxzW2tleV07XG5cdFx0aWYoaXRlbS5sZW5ndGgpe1xuXHRcdFx0Ly8gY29udmVydCB0aGUgYml0IHNldCB0byB2YWx1ZVxuXHRcdFx0b3V0W2tleV0gPSBiaXRzVG9OdW0oYml0cy5zbGljZShpdGVtLmluZGV4LCBpdGVtLmluZGV4ICsgaXRlbS5sZW5ndGgpKTtcblx0XHR9ZWxzZXtcblx0XHRcdG91dFtrZXldID0gYml0c1tpdGVtLmluZGV4XTtcblx0XHR9XG5cdH1cblx0cmV0dXJuIG91dDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gRGF0YVBhcnNlcjsiLCJcbi8vIGEgc2V0IG9mIGNvbW1vbiBwYXJzZXJzIHVzZWQgd2l0aCBEYXRhUGFyc2VyXG5cbnZhciBQYXJzZXJzID0ge1xuXHQvLyByZWFkIGEgYnl0ZVxuXHRyZWFkQnl0ZTogZnVuY3Rpb24oKXtcblx0XHRyZXR1cm4gZnVuY3Rpb24oc3RyZWFtKXtcblx0XHRcdHJldHVybiBzdHJlYW0ucmVhZEJ5dGUoKTtcblx0XHR9O1xuXHR9LFxuXHQvLyByZWFkIGFuIGFycmF5IG9mIGJ5dGVzXG5cdHJlYWRCeXRlczogZnVuY3Rpb24obGVuZ3RoKXtcblx0XHRyZXR1cm4gZnVuY3Rpb24oc3RyZWFtKXtcblx0XHRcdHJldHVybiBzdHJlYW0ucmVhZEJ5dGVzKGxlbmd0aCk7XG5cdFx0fTtcblx0fSxcblx0Ly8gcmVhZCBhIHN0cmluZyBmcm9tIGJ5dGVzXG5cdHJlYWRTdHJpbmc6IGZ1bmN0aW9uKGxlbmd0aCl7XG5cdFx0cmV0dXJuIGZ1bmN0aW9uKHN0cmVhbSl7XG5cdFx0XHRyZXR1cm4gc3RyZWFtLnJlYWRTdHJpbmcobGVuZ3RoKTtcblx0XHR9O1xuXHR9LFxuXHQvLyByZWFkIGFuIHVuc2lnbmVkIGludCAod2l0aCBlbmRpYW4pXG5cdHJlYWRVbnNpZ25lZDogZnVuY3Rpb24obGl0dGxlRW5kaWFuKXtcblx0XHRyZXR1cm4gZnVuY3Rpb24oc3RyZWFtKXtcblx0XHRcdHJldHVybiBzdHJlYW0ucmVhZFVuc2lnbmVkKGxpdHRsZUVuZGlhbik7XG5cdFx0fTtcblx0fSxcblx0Ly8gcmVhZCBhbiBhcnJheSBvZiBieXRlIHNldHNcblx0cmVhZEFycmF5OiBmdW5jdGlvbihzaXplLCBjb3VudEZ1bmMpe1xuXHRcdHJldHVybiBmdW5jdGlvbihzdHJlYW0sIG9iaiwgcGFyZW50KXtcblx0XHRcdHZhciBjb3VudCA9IGNvdW50RnVuYyhzdHJlYW0sIG9iaiwgcGFyZW50KTtcblx0XHRcdHZhciBhcnIgPSBuZXcgQXJyYXkoY291bnQpO1xuXHRcdFx0Zm9yKHZhciBpPTA7IGk8Y291bnQ7IGkrKyl7XG5cdFx0XHRcdGFycltpXSA9IHN0cmVhbS5yZWFkQnl0ZXMoc2l6ZSk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gYXJyO1xuXHRcdH07XG5cdH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gUGFyc2VyczsiLCIvLyBleHBvcnQgd3JhcHBlciBmb3IgZXhwb3NpbmcgbGlicmFyeVxuXG52YXIgR0lGID0gd2luZG93LkdJRiB8fCB7fTtcblxuR0lGID0gcmVxdWlyZSgnLi9naWYnKTtcblxud2luZG93LkdJRiA9IEdJRjsiLCJcbi8vIG9iamVjdCB1c2VkIHRvIHJlcHJlc2VudCBhcnJheSBidWZmZXIgZGF0YSBmb3IgYSBnaWYgZmlsZVxuXG52YXIgRGF0YVBhcnNlciA9IHJlcXVpcmUoJy4uL2Jvd2VyX2NvbXBvbmVudHMvanMtYmluYXJ5LXNjaGVtYS1wYXJzZXIvc3JjL2RhdGFwYXJzZXInKTtcbnZhciBnaWZTY2hlbWEgPSByZXF1aXJlKCcuL3NjaGVtYScpO1xuXG5mdW5jdGlvbiBHSUYoYXJyYXlCdWZmZXIpe1xuXHQvLyBjb252ZXJ0IHRvIGJ5dGUgYXJyYXlcblx0dmFyIGJ5dGVEYXRhID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlCdWZmZXIpO1xuXHR2YXIgcGFyc2VyID0gbmV3IERhdGFQYXJzZXIoYnl0ZURhdGEpO1xuXHQvLyBwYXJzZSB0aGUgZGF0YVxuXHR0aGlzLnJhdyA9IHBhcnNlci5wYXJzZShnaWZTY2hlbWEpO1xuXG5cdC8vIHNldCBhIGZsYWcgdG8gbWFrZSBzdXJlIHRoZSBnaWYgY29udGFpbnMgYXQgbGVhc3Qgb25lIGltYWdlXG5cdHRoaXMucmF3Lmhhc0ltYWdlcyA9IGZhbHNlO1xuXHRmb3IodmFyIGY9MDsgZjx0aGlzLnJhdy5mcmFtZXMubGVuZ3RoOyBmKyspe1xuXHRcdGlmKHRoaXMucmF3LmZyYW1lc1tmXS5pbWFnZSl7XG5cdFx0XHR0aGlzLnJhdy5oYXNJbWFnZXMgPSB0cnVlO1xuXHRcdFx0YnJlYWs7XG5cdFx0fVxuXHR9XG59XG5cbi8vIHByb2Nlc3MgYSBzaW5nbGUgZ2lmIGltYWdlIGZyYW1lcyBkYXRhLCBkZWNvbXByZXNzaW5nIGl0IHVzaW5nIExaVyBcbi8vIGlmIGJ1aWxkUGF0Y2ggaXMgdHJ1ZSwgdGhlIHJldHVybmVkIGltYWdlIHdpbGwgYmUgYSBjbGFtcGVkIDggYml0IGltYWdlIHBhdGNoXG4vLyBmb3IgdXNlIGRpcmVjdGx5IHdpdGggYSBjYW52YXMuXG5HSUYucHJvdG90eXBlLmRlY29tcHJlc3NGcmFtZSA9IGZ1bmN0aW9uKGluZGV4LCBidWlsZFBhdGNoKXtcblxuXHQvLyBtYWtlIHN1cmUgYSB2YWxpZCBmcmFtZSBpcyByZXF1ZXN0ZWRcblx0aWYoaW5kZXggPj0gdGhpcy5yYXcuZnJhbWVzLmxlbmd0aCl7IHJldHVybiBudWxsOyB9XG5cblx0dmFyIGZyYW1lID0gdGhpcy5yYXcuZnJhbWVzW2luZGV4XTtcblx0aWYoZnJhbWUuaW1hZ2Upe1xuXHRcdC8vIGdldCB0aGUgbnVtYmVyIG9mIHBpeGVsc1xuXHRcdHZhciB0b3RhbFBpeGVscyA9IGZyYW1lLmltYWdlLmRlc2NyaXB0b3Iud2lkdGggKiBmcmFtZS5pbWFnZS5kZXNjcmlwdG9yLmhlaWdodDtcblxuXHRcdC8vIGRvIGx6dyBkZWNvbXByZXNzaW9uXG5cdFx0dmFyIHBpeGVscyA9IGx6dyhmcmFtZS5pbWFnZS5kYXRhLm1pbkNvZGVTaXplLCBmcmFtZS5pbWFnZS5kYXRhLmJsb2NrcywgdG90YWxQaXhlbHMpO1xuXG5cdFx0Ly8gZGVhbCB3aXRoIGludGVybGFjaW5nIGlmIG5lY2Vzc2FyeVxuXHRcdGlmKGZyYW1lLmltYWdlLmRlc2NyaXB0b3IubGN0LmludGVybGFjZWQpe1xuXHRcdFx0cGl4ZWxzID0gZGVpbnRlcmxhY2UocGl4ZWxzLCBmcmFtZS5pbWFnZS5kZXNjcmlwdG9yLndpZHRoKTtcblx0XHR9XG5cblx0XHQvLyBzZXR1cCB1c2FibGUgaW1hZ2Ugb2JqZWN0XG5cdFx0dmFyIGltYWdlID0ge1xuXHRcdFx0cGl4ZWxzOiBwaXhlbHMsXG5cdFx0XHRkaW1zOiB7XG5cdFx0XHRcdHRvcDogZnJhbWUuaW1hZ2UuZGVzY3JpcHRvci50b3AsXG5cdFx0XHRcdGxlZnQ6IGZyYW1lLmltYWdlLmRlc2NyaXB0b3IubGVmdCxcblx0XHRcdFx0d2lkdGg6IGZyYW1lLmltYWdlLmRlc2NyaXB0b3Iud2lkdGgsXG5cdFx0XHRcdGhlaWdodDogZnJhbWUuaW1hZ2UuZGVzY3JpcHRvci5oZWlnaHRcblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0Ly8gY29sb3IgdGFibGVcblx0XHRpZihmcmFtZS5pbWFnZS5kZXNjcmlwdG9yLmxjdCAmJiBmcmFtZS5pbWFnZS5kZXNjcmlwdG9yLmxjdC5leGlzdHMpe1xuXHRcdFx0aW1hZ2UuY29sb3JUYWJsZSA9IGZyYW1lLmltYWdlLmxjdDtcblx0XHR9ZWxzZXtcblx0XHRcdGltYWdlLmNvbG9yVGFibGUgPSB0aGlzLnJhdy5nY3Q7XG5cdFx0fVxuXG5cdFx0Ly8gYWRkIHBlciBmcmFtZSByZWxldmFudCBnY2UgaW5mb3JtYXRpb25cblx0XHRpZihmcmFtZS5nY2Upe1xuXHRcdFx0aW1hZ2UuZGVsYXkgPSAoZnJhbWUuZ2NlLmRlbGF5IHx8IDEwKSAqIDEwOyAvLyBjb252ZXJ0IHRvIG1zXG5cdFx0XHRpbWFnZS5kaXNwb3NhbFR5cGUgPSBmcmFtZS5nY2UuZXh0cmFzLmRpc3Bvc2FsO1xuXHRcdFx0Ly8gdHJhbnNwYXJlbmN5XG5cdFx0XHRpZihmcmFtZS5nY2UuZXh0cmFzLnRyYW5zcGFyZW50Q29sb3JHaXZlbil7XG5cdFx0XHRcdGltYWdlLnRyYW5zcGFyZW50SW5kZXggPSBmcmFtZS5nY2UudHJhbnNwYXJlbnRDb2xvckluZGV4O1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIGNyZWF0ZSBjYW52YXMgdXNhYmxlIGltYWdlZGF0YSBpZiBkZXNpcmVkXG5cdFx0aWYoYnVpbGRQYXRjaCl7XG5cdFx0XHRpbWFnZS5wYXRjaCA9IGdlbmVyYXRlUGF0Y2goaW1hZ2UpO1xuXHRcdH1cblxuXHRcdHJldHVybiBpbWFnZTtcdFx0XG5cdH1cblxuXHQvLyBmcmFtZSBkb2VzIG5vdCBjb250YWlucyBpbWFnZVxuXHRyZXR1cm4gbnVsbDtcblxuXG5cdC8qKlxuXHQgKiBqYXZhc2NyaXB0IHBvcnQgb2YgamF2YSBMWlcgZGVjb21wcmVzc2lvblxuXHQgKiBPcmlnaW5hbCBqYXZhIGF1dGhvciB1cmw6IGh0dHBzOi8vZ2lzdC5naXRodWIuY29tL2RldnVud2lyZWQvNDQ3OTIzMVxuXHQgKi9cdFxuXHRmdW5jdGlvbiBsencobWluQ29kZVNpemUsIGRhdGEsIHBpeGVsQ291bnQpIHtcbiBcdFx0XG4gXHRcdHZhciBNQVhfU1RBQ0tfU0laRSA9IDQwOTY7XG5cdFx0dmFyIG51bGxDb2RlID0gLTE7XG5cblx0XHR2YXIgbnBpeCA9IHBpeGVsQ291bnQ7XG5cdFx0dmFyIGF2YWlsYWJsZSwgY2xlYXIsIGNvZGVfbWFzaywgY29kZV9zaXplLCBlbmRfb2ZfaW5mb3JtYXRpb24sIGluX2NvZGUsIG9sZF9jb2RlLCBiaXRzLCBjb2RlLCBpLCBkYXR1bSwgZGF0YV9zaXplLCBmaXJzdCwgdG9wLCBiaSwgcGk7XG4gXG4gXHRcdHZhciBkc3RQaXhlbHMgPSBuZXcgQXJyYXkocGl4ZWxDb3VudCk7XG5cdFx0dmFyIHByZWZpeCA9IG5ldyBBcnJheShNQVhfU1RBQ0tfU0laRSk7XG5cdFx0dmFyIHN1ZmZpeCA9IG5ldyBBcnJheShNQVhfU1RBQ0tfU0laRSk7XG5cdFx0dmFyIHBpeGVsU3RhY2sgPSBuZXcgQXJyYXkoTUFYX1NUQUNLX1NJWkUgKyAxKTtcbiBcblx0XHQvLyBJbml0aWFsaXplIEdJRiBkYXRhIHN0cmVhbSBkZWNvZGVyLlxuXHRcdGRhdGFfc2l6ZSA9IG1pbkNvZGVTaXplO1xuXHRcdGNsZWFyID0gMSA8PCBkYXRhX3NpemU7XG5cdFx0ZW5kX29mX2luZm9ybWF0aW9uID0gY2xlYXIgKyAxO1xuXHRcdGF2YWlsYWJsZSA9IGNsZWFyICsgMjtcblx0XHRvbGRfY29kZSA9IG51bGxDb2RlO1xuXHRcdGNvZGVfc2l6ZSA9IGRhdGFfc2l6ZSArIDE7XG5cdFx0Y29kZV9tYXNrID0gKDEgPDwgY29kZV9zaXplKSAtIDE7XG5cdFx0Zm9yIChjb2RlID0gMDsgY29kZSA8IGNsZWFyOyBjb2RlKyspIHtcblx0XHRcdHByZWZpeFtjb2RlXSA9IDA7XG5cdFx0XHRzdWZmaXhbY29kZV0gPSBjb2RlO1xuXHRcdH1cbiBcblx0XHQvLyBEZWNvZGUgR0lGIHBpeGVsIHN0cmVhbS5cblx0XHRkYXR1bSA9IGJpdHMgPSBjb3VudCA9IGZpcnN0ID0gdG9wID0gcGkgPSBiaSA9IDA7XG5cdFx0Zm9yIChpID0gMDsgaSA8IG5waXg7ICkge1xuXHRcdFx0aWYgKHRvcCA9PT0gMCkge1xuXHRcdFx0XHRpZiAoYml0cyA8IGNvZGVfc2l6ZSkge1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdC8vIGdldCB0aGUgbmV4dCBieXRlXHRcdFx0XG5cdFx0XHRcdFx0ZGF0dW0gKz0gZGF0YVtiaV0gPDwgYml0cztcblxuXHRcdFx0XHRcdGJpdHMgKz0gODtcblx0XHRcdFx0XHRiaSsrO1xuXHRcdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0XHR9XG5cdFx0XHRcdC8vIEdldCB0aGUgbmV4dCBjb2RlLlxuXHRcdFx0XHRjb2RlID0gZGF0dW0gJiBjb2RlX21hc2s7XG5cdFx0XHRcdGRhdHVtID4+PSBjb2RlX3NpemU7XG5cdFx0XHRcdGJpdHMgLT0gY29kZV9zaXplO1xuXHRcdFx0XHQvLyBJbnRlcnByZXQgdGhlIGNvZGVcblx0XHRcdFx0aWYgKChjb2RlID4gYXZhaWxhYmxlKSB8fCAoY29kZSA9PSBlbmRfb2ZfaW5mb3JtYXRpb24pKSB7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKGNvZGUgPT0gY2xlYXIpIHtcblx0XHRcdFx0XHQvLyBSZXNldCBkZWNvZGVyLlxuXHRcdFx0XHRcdGNvZGVfc2l6ZSA9IGRhdGFfc2l6ZSArIDE7XG5cdFx0XHRcdFx0Y29kZV9tYXNrID0gKDEgPDwgY29kZV9zaXplKSAtIDE7XG5cdFx0XHRcdFx0YXZhaWxhYmxlID0gY2xlYXIgKyAyO1xuXHRcdFx0XHRcdG9sZF9jb2RlID0gbnVsbENvZGU7XG5cdFx0XHRcdFx0Y29udGludWU7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKG9sZF9jb2RlID09IG51bGxDb2RlKSB7XG5cdFx0XHRcdFx0cGl4ZWxTdGFja1t0b3ArK10gPSBzdWZmaXhbY29kZV07XG5cdFx0XHRcdFx0b2xkX2NvZGUgPSBjb2RlO1xuXHRcdFx0XHRcdGZpcnN0ID0gY29kZTtcblx0XHRcdFx0XHRjb250aW51ZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpbl9jb2RlID0gY29kZTtcblx0XHRcdFx0aWYgKGNvZGUgPT0gYXZhaWxhYmxlKSB7XG5cdFx0XHRcdFx0cGl4ZWxTdGFja1t0b3ArK10gPSBmaXJzdDtcblx0XHRcdFx0XHRjb2RlID0gb2xkX2NvZGU7XG5cdFx0XHRcdH1cblx0XHRcdFx0d2hpbGUgKGNvZGUgPiBjbGVhcikge1xuXHRcdFx0XHRcdHBpeGVsU3RhY2tbdG9wKytdID0gc3VmZml4W2NvZGVdO1xuXHRcdFx0XHRcdGNvZGUgPSBwcmVmaXhbY29kZV07XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdGZpcnN0ID0gc3VmZml4W2NvZGVdICYgMHhmZjtcblx0XHRcdFx0cGl4ZWxTdGFja1t0b3ArK10gPSBmaXJzdDtcblxuXHRcdFx0XHQvLyBhZGQgYSBuZXcgc3RyaW5nIHRvIHRoZSB0YWJsZSwgYnV0IG9ubHkgaWYgc3BhY2UgaXMgYXZhaWxhYmxlXG5cdFx0XHRcdC8vIGlmIG5vdCwganVzdCBjb250aW51ZSB3aXRoIGN1cnJlbnQgdGFibGUgdW50aWwgYSBjbGVhciBjb2RlIGlzIGZvdW5kXG5cdFx0XHRcdC8vIChkZWZlcnJlZCBjbGVhciBjb2RlIGltcGxlbWVudGF0aW9uIGFzIHBlciBHSUYgc3BlYylcblx0XHRcdFx0aWYoYXZhaWxhYmxlIDwgTUFYX1NUQUNLX1NJWkUpe1xuXHRcdFx0XHRcdHByZWZpeFthdmFpbGFibGVdID0gb2xkX2NvZGU7XG5cdFx0XHRcdFx0c3VmZml4W2F2YWlsYWJsZV0gPSBmaXJzdDtcblx0XHRcdFx0XHRhdmFpbGFibGUrKztcblx0XHRcdFx0XHRpZiAoKChhdmFpbGFibGUgJiBjb2RlX21hc2spID09PSAwKSAmJiAoYXZhaWxhYmxlIDwgTUFYX1NUQUNLX1NJWkUpKSB7XG5cdFx0XHRcdFx0XHRjb2RlX3NpemUrKztcblx0XHRcdFx0XHRcdGNvZGVfbWFzayArPSBhdmFpbGFibGU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdG9sZF9jb2RlID0gaW5fY29kZTtcblx0XHRcdH1cblx0XHRcdC8vIFBvcCBhIHBpeGVsIG9mZiB0aGUgcGl4ZWwgc3RhY2suXG5cdFx0XHR0b3AtLTtcblx0XHRcdGRzdFBpeGVsc1twaSsrXSA9IHBpeGVsU3RhY2tbdG9wXTtcblx0XHRcdGkrKztcblx0XHR9XG5cblx0XHRmb3IgKGkgPSBwaTsgaSA8IG5waXg7IGkrKykge1xuXHRcdFx0ZHN0UGl4ZWxzW2ldID0gMDsgLy8gY2xlYXIgbWlzc2luZyBwaXhlbHNcblx0XHR9XG5cblx0XHRyZXR1cm4gZHN0UGl4ZWxzO1xuXHR9XG5cblx0Ly8gZGVpbnRlcmxhY2UgZnVuY3Rpb24gZnJvbSBodHRwczovL2dpdGh1Yi5jb20vc2hhY2hhZi9qc2dpZlxuXHRmdW5jdGlvbiBkZWludGVybGFjZShwaXhlbHMsIHdpZHRoKSB7XG5cdFx0XG5cdFx0dmFyIG5ld1BpeGVscyA9IG5ldyBBcnJheShwaXhlbHMubGVuZ3RoKTtcblx0XHR2YXIgcm93cyA9IHBpeGVscy5sZW5ndGggLyB3aWR0aDtcblx0XHR2YXIgY3BSb3cgPSBmdW5jdGlvbih0b1JvdywgZnJvbVJvdykge1xuXHRcdFx0dmFyIGZyb21QaXhlbHMgPSBwaXhlbHMuc2xpY2UoZnJvbVJvdyAqIHdpZHRoLCAoZnJvbVJvdyArIDEpICogd2lkdGgpO1xuXHRcdFx0bmV3UGl4ZWxzLnNwbGljZS5hcHBseShuZXdQaXhlbHMsIFt0b1JvdyAqIHdpZHRoLCB3aWR0aF0uY29uY2F0KGZyb21QaXhlbHMpKTtcblx0XHR9O1xuXG5cdFx0Ly8gU2VlIGFwcGVuZGl4IEUuXG5cdFx0dmFyIG9mZnNldHMgPSBbMCw0LDIsMV07XG5cdFx0dmFyIHN0ZXBzICAgPSBbOCw4LDQsMl07XG5cblx0XHR2YXIgZnJvbVJvdyA9IDA7XG5cdFx0Zm9yICh2YXIgcGFzcyA9IDA7IHBhc3MgPCA0OyBwYXNzKyspIHtcblx0XHRcdGZvciAodmFyIHRvUm93ID0gb2Zmc2V0c1twYXNzXTsgdG9Sb3cgPCByb3dzOyB0b1JvdyArPSBzdGVwc1twYXNzXSkge1xuXHRcdFx0XHRjcFJvdyh0b1JvdywgZnJvbVJvdyk7XG5cdFx0XHRcdGZyb21Sb3crKztcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gbmV3UGl4ZWxzO1xuXHR9XG5cblx0Ly8gY3JlYXRlIGEgY2xhbXBlZCBieXRlIGFycmF5IHBhdGNoIGZvciB0aGUgZnJhbWUgaW1hZ2UgdG8gYmUgdXNlZCBkaXJlY3RseSB3aXRoIGEgY2FudmFzXG5cdC8vIFRPRE86IGNvdWxkIHBvdGVudGlhbGx5IHNxdWVlemUgc29tZSBwZXJmb3JtYW5jZSBieSBkb2luZyBhIGRpcmVjdCAzMmJpdCB3cml0ZSBwZXIgaXRlcmF0aW9uXG5cdGZ1bmN0aW9uIGdlbmVyYXRlUGF0Y2goaW1hZ2Upe1xuXG5cdFx0dmFyIHRvdGFsUGl4ZWxzID0gaW1hZ2UucGl4ZWxzLmxlbmd0aDtcblx0XHR2YXIgcGF0Y2hEYXRhID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHRvdGFsUGl4ZWxzICogNCk7XG5cdFx0Zm9yKHZhciBpPTA7IGk8dG90YWxQaXhlbHM7IGkrKyl7XG5cdFx0XHR2YXIgcG9zID0gaSAqIDQ7XG5cdFx0XHR2YXIgY29sb3JJbmRleCA9IGltYWdlLnBpeGVsc1tpXTtcblx0XHRcdHZhciBjb2xvciA9IGltYWdlLmNvbG9yVGFibGVbY29sb3JJbmRleF07XG5cdFx0XHRwYXRjaERhdGFbcG9zXSA9IGNvbG9yWzBdO1xuXHRcdFx0cGF0Y2hEYXRhW3BvcyArIDFdID0gY29sb3JbMV07XG5cdFx0XHRwYXRjaERhdGFbcG9zICsgMl0gPSBjb2xvclsyXTtcblx0XHRcdHBhdGNoRGF0YVtwb3MgKyAzXSA9IGNvbG9ySW5kZXggIT09IGltYWdlLnRyYW5zcGFyZW50SW5kZXggPyAyNTUgOiAwO1xuXHRcdH1cblxuXHRcdHJldHVybiBwYXRjaERhdGE7XG5cdH1cbn07XG5cbi8vIHJldHVybnMgYWxsIGZyYW1lcyBkZWNvbXByZXNzZWRcbkdJRi5wcm90b3R5cGUuZGVjb21wcmVzc0ZyYW1lcyA9IGZ1bmN0aW9uKGJ1aWxkUGF0Y2gpe1xuXHR2YXIgZnJhbWVzID0gW107XG5cdGZvcih2YXIgaT0wOyBpPHRoaXMucmF3LmZyYW1lcy5sZW5ndGg7IGkrKyl7XG5cdFx0dmFyIGZyYW1lID0gdGhpcy5yYXcuZnJhbWVzW2ldO1xuXHRcdGlmKGZyYW1lLmltYWdlKXtcblx0XHRcdGZyYW1lcy5wdXNoKHRoaXMuZGVjb21wcmVzc0ZyYW1lKGksIGJ1aWxkUGF0Y2gpKTtcblx0XHR9XG5cdH1cblx0cmV0dXJuIGZyYW1lcztcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gR0lGOyIsIlxuLy8gU2NoZW1hIGZvciB0aGUganMgZmlsZSBwYXJzZXIgdG8gdXNlIHRvIHBhcnNlIGdpZiBmaWxlc1xuLy8gRm9yIGpzIG9iamVjdCBjb252ZW5pZW5jZSAocmUtdXNlKSwgdGhlIHNjaGVtYSBvYmplY3RzIGFyZSBhcHByb3hpbWF0ZWx5IHJldmVyc2Ugb3JkZXJlZFxuXG4vLyBjb21tb24gcGFyc2VycyBhdmFpbGFibGVcbnZhciBQYXJzZXJzID0gcmVxdWlyZSgnLi4vYm93ZXJfY29tcG9uZW50cy9qcy1iaW5hcnktc2NoZW1hLXBhcnNlci9zcmMvcGFyc2VycycpO1xuXG4vLyBhIHNldCBvZiAweDAwIHRlcm1pbmF0ZWQgc3ViYmxvY2tzXG52YXIgc3ViQmxvY2tzID0ge1xuXHRsYWJlbDogJ2Jsb2NrcycsXG5cdHBhcnNlcjogZnVuY3Rpb24oc3RyZWFtKXtcblx0XHR2YXIgb3V0ID0gW107XG5cdFx0dmFyIHRlcm1pbmF0b3IgPSAweDAwO1x0XHRcblx0XHRmb3IodmFyIHNpemU9c3RyZWFtLnJlYWRCeXRlKCk7IHNpemUhPT10ZXJtaW5hdG9yOyBzaXplPXN0cmVhbS5yZWFkQnl0ZSgpKXtcblx0XHRcdG91dCA9IG91dC5jb25jYXQoc3RyZWFtLnJlYWRCeXRlcyhzaXplKSk7XG5cdFx0fVxuXHRcdHJldHVybiBvdXQ7XG5cdH1cbn07XG5cbi8vIGdsb2JhbCBjb250cm9sIGV4dGVuc2lvblxudmFyIGdjZSA9IHtcblx0bGFiZWw6ICdnY2UnLFxuXHRyZXF1aXJlczogZnVuY3Rpb24oc3RyZWFtKXtcblx0XHQvLyBqdXN0IHBlZWsgYXQgdGhlIHRvcCB0d28gYnl0ZXMsIGFuZCBpZiB0cnVlIGRvIHRoaXNcblx0XHR2YXIgY29kZXMgPSBzdHJlYW0ucGVla0J5dGVzKDIpO1xuXHRcdHJldHVybiBjb2Rlc1swXSA9PT0gMHgyMSAmJiBjb2Rlc1sxXSA9PT0gMHhGOTtcblx0fSxcblx0cGFydHM6IFtcblx0XHR7IGxhYmVsOiAnY29kZXMnLCBwYXJzZXI6IFBhcnNlcnMucmVhZEJ5dGVzKDIpLCBza2lwOiB0cnVlIH0sXG5cdFx0eyBsYWJlbDogJ2J5dGVTaXplJywgcGFyc2VyOiBQYXJzZXJzLnJlYWRCeXRlKCkgfSxcblx0XHR7IGxhYmVsOiAnZXh0cmFzJywgYml0czoge1xuXHRcdFx0ZnV0dXJlOiB7IGluZGV4OiAwLCBsZW5ndGg6IDMgfSxcblx0XHRcdGRpc3Bvc2FsOiB7IGluZGV4OiAzLCBsZW5ndGg6IDMgfSxcblx0XHRcdHVzZXJJbnB1dDogeyBpbmRleDogNiB9LFxuXHRcdFx0dHJhbnNwYXJlbnRDb2xvckdpdmVuOiB7IGluZGV4OiA3IH1cblx0XHR9fSxcblx0XHR7IGxhYmVsOiAnZGVsYXknLCBwYXJzZXI6IFBhcnNlcnMucmVhZFVuc2lnbmVkKHRydWUpIH0sXG5cdFx0eyBsYWJlbDogJ3RyYW5zcGFyZW50Q29sb3JJbmRleCcsIHBhcnNlcjogUGFyc2Vycy5yZWFkQnl0ZSgpIH0sXG5cdFx0eyBsYWJlbDogJ3Rlcm1pbmF0b3InLCBwYXJzZXI6IFBhcnNlcnMucmVhZEJ5dGUoKSwgc2tpcDogdHJ1ZSB9XG5cdF1cbn07XG5cbi8vIGltYWdlIHBpcGVsaW5lIGJsb2NrXG52YXIgaW1hZ2UgPSB7XG5cdGxhYmVsOiAnaW1hZ2UnLFxuXHRyZXF1aXJlczogZnVuY3Rpb24oc3RyZWFtKXtcblx0XHQvLyBwZWVrIGF0IHRoZSBuZXh0IGJ5dGVcblx0XHR2YXIgY29kZSA9IHN0cmVhbS5wZWVrQnl0ZSgpO1xuXHRcdHJldHVybiBjb2RlID09PSAweDJDO1xuXHR9LFxuXHRwYXJ0czogW1xuXHRcdHsgbGFiZWw6ICdjb2RlJywgcGFyc2VyOiBQYXJzZXJzLnJlYWRCeXRlKCksIHNraXA6IHRydWUgfSxcblx0XHR7XG5cdFx0XHRsYWJlbDogJ2Rlc2NyaXB0b3InLCAvLyBpbWFnZSBkZXNjcmlwdG9yXG5cdFx0XHRwYXJ0czogW1xuXHRcdFx0XHR7IGxhYmVsOiAnbGVmdCcsIHBhcnNlcjogUGFyc2Vycy5yZWFkVW5zaWduZWQodHJ1ZSkgfSxcblx0XHRcdFx0eyBsYWJlbDogJ3RvcCcsIHBhcnNlcjogUGFyc2Vycy5yZWFkVW5zaWduZWQodHJ1ZSkgfSxcblx0XHRcdFx0eyBsYWJlbDogJ3dpZHRoJywgcGFyc2VyOiBQYXJzZXJzLnJlYWRVbnNpZ25lZCh0cnVlKSB9LFxuXHRcdFx0XHR7IGxhYmVsOiAnaGVpZ2h0JywgcGFyc2VyOiBQYXJzZXJzLnJlYWRVbnNpZ25lZCh0cnVlKSB9LFxuXHRcdFx0XHR7IGxhYmVsOiAnbGN0JywgYml0czoge1xuXHRcdFx0XHRcdGV4aXN0czogeyBpbmRleDogMCB9LFxuXHRcdFx0XHRcdGludGVybGFjZWQ6IHsgaW5kZXg6IDEgfSxcblx0XHRcdFx0XHRzb3J0OiB7IGluZGV4OiAyIH0sXG5cdFx0XHRcdFx0ZnV0dXJlOiB7IGluZGV4OiAzLCBsZW5ndGg6IDIgfSxcblx0XHRcdFx0XHRzaXplOiB7IGluZGV4OiA1LCBsZW5ndGg6IDMgfVxuXHRcdFx0XHR9fVxuXHRcdFx0XVxuXHRcdH0se1xuXHRcdFx0bGFiZWw6ICdsY3QnLCAvLyBvcHRpb25hbCBsb2NhbCBjb2xvciB0YWJsZVxuXHRcdFx0cmVxdWlyZXM6IGZ1bmN0aW9uKHN0cmVhbSwgb2JqLCBwYXJlbnQpe1xuXHRcdFx0XHRyZXR1cm4gcGFyZW50LmRlc2NyaXB0b3IubGN0LmV4aXN0cztcblx0XHRcdH0sXG5cdFx0XHRwYXJzZXI6IFBhcnNlcnMucmVhZEFycmF5KDMsIGZ1bmN0aW9uKHN0cmVhbSwgb2JqLCBwYXJlbnQpe1xuXHRcdFx0XHRyZXR1cm4gTWF0aC5wb3coMiwgcGFyZW50LmRlc2NyaXB0b3IubGN0LnNpemUgKyAxKTtcblx0XHRcdH0pXG5cdFx0fSx7XG5cdFx0XHRsYWJlbDogJ2RhdGEnLCAvLyB0aGUgaW1hZ2UgZGF0YSBibG9ja3Ncblx0XHRcdHBhcnRzOiBbXG5cdFx0XHRcdHsgbGFiZWw6ICdtaW5Db2RlU2l6ZScsIHBhcnNlcjogUGFyc2Vycy5yZWFkQnl0ZSgpIH0sXG5cdFx0XHRcdHN1YkJsb2Nrc1xuXHRcdFx0XVxuXHRcdH1cblx0XVxufTtcblxuLy8gcGxhaW4gdGV4dCBibG9ja1xudmFyIHRleHQgPSB7XG5cdGxhYmVsOiAndGV4dCcsXG5cdHJlcXVpcmVzOiBmdW5jdGlvbihzdHJlYW0pe1xuXHRcdC8vIGp1c3QgcGVlayBhdCB0aGUgdG9wIHR3byBieXRlcywgYW5kIGlmIHRydWUgZG8gdGhpc1xuXHRcdHZhciBjb2RlcyA9IHN0cmVhbS5wZWVrQnl0ZXMoMik7XG5cdFx0cmV0dXJuIGNvZGVzWzBdID09PSAweDIxICYmIGNvZGVzWzFdID09PSAweDAxO1xuXHR9LFxuXHRwYXJ0czogW1xuXHRcdHsgbGFiZWw6ICdjb2RlcycsIHBhcnNlcjogUGFyc2Vycy5yZWFkQnl0ZXMoMiksIHNraXA6IHRydWUgfSxcblx0XHR7IGxhYmVsOiAnYmxvY2tTaXplJywgcGFyc2VyOiBQYXJzZXJzLnJlYWRCeXRlKCkgfSxcblx0XHR7IFxuXHRcdFx0bGFiZWw6ICdwcmVEYXRhJywgXG5cdFx0XHRwYXJzZXI6IGZ1bmN0aW9uKHN0cmVhbSwgb2JqLCBwYXJlbnQpe1xuXHRcdFx0XHRyZXR1cm4gc3RyZWFtLnJlYWRCeXRlcyhwYXJlbnQudGV4dC5ibG9ja1NpemUpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0c3ViQmxvY2tzXG5cdF1cbn07XG5cbi8vIGFwcGxpY2F0aW9uIGJsb2NrXG52YXIgYXBwbGljYXRpb24gPSB7XG5cdGxhYmVsOiAnYXBwbGljYXRpb24nLFxuXHRyZXF1aXJlczogZnVuY3Rpb24oc3RyZWFtLCBvYmosIHBhcmVudCl7XG5cdFx0Ly8gbWFrZSBzdXJlIHRoaXMgZnJhbWUgZG9lc24ndCBhbHJlYWR5IGhhdmUgYSBnY2UsIHRleHQsIGNvbW1lbnQsIG9yIGltYWdlXG5cdFx0Ly8gYXMgdGhhdCBtZWFucyB0aGlzIGJsb2NrIHNob3VsZCBiZSBhdHRhY2hlZCB0byB0aGUgbmV4dCBmcmFtZVxuXHRcdC8vaWYocGFyZW50LmdjZSB8fCBwYXJlbnQudGV4dCB8fCBwYXJlbnQuaW1hZ2UgfHwgcGFyZW50LmNvbW1lbnQpeyByZXR1cm4gZmFsc2U7IH1cblxuXHRcdC8vIHBlZWsgYXQgdGhlIHRvcCB0d28gYnl0ZXNcblx0XHR2YXIgY29kZXMgPSBzdHJlYW0ucGVla0J5dGVzKDIpO1xuXHRcdHJldHVybiBjb2Rlc1swXSA9PT0gMHgyMSAmJiBjb2Rlc1sxXSA9PT0gMHhGRjtcblx0fSxcblx0cGFydHM6IFtcblx0XHR7IGxhYmVsOiAnY29kZXMnLCBwYXJzZXI6IFBhcnNlcnMucmVhZEJ5dGVzKDIpLCBza2lwOiB0cnVlIH0sXG5cdFx0eyBsYWJlbDogJ2Jsb2NrU2l6ZScsIHBhcnNlcjogUGFyc2Vycy5yZWFkQnl0ZSgpIH0sXG5cdFx0eyBcblx0XHRcdGxhYmVsOiAnaWQnLCBcblx0XHRcdHBhcnNlcjogZnVuY3Rpb24oc3RyZWFtLCBvYmosIHBhcmVudCl7XG5cdFx0XHRcdHJldHVybiBzdHJlYW0ucmVhZFN0cmluZyhwYXJlbnQuYmxvY2tTaXplKTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdHN1YkJsb2Nrc1xuXHRdXG59O1xuXG4vLyBjb21tZW50IGJsb2NrXG52YXIgY29tbWVudCA9IHtcblx0bGFiZWw6ICdjb21tZW50Jyxcblx0cmVxdWlyZXM6IGZ1bmN0aW9uKHN0cmVhbSwgb2JqLCBwYXJlbnQpe1xuXHRcdC8vIG1ha2Ugc3VyZSB0aGlzIGZyYW1lIGRvZXNuJ3QgYWxyZWFkeSBoYXZlIGEgZ2NlLCB0ZXh0LCBjb21tZW50LCBvciBpbWFnZVxuXHRcdC8vIGFzIHRoYXQgbWVhbnMgdGhpcyBibG9jayBzaG91bGQgYmUgYXR0YWNoZWQgdG8gdGhlIG5leHQgZnJhbWVcblx0XHQvL2lmKHBhcmVudC5nY2UgfHwgcGFyZW50LnRleHQgfHwgcGFyZW50LmltYWdlIHx8IHBhcmVudC5jb21tZW50KXsgcmV0dXJuIGZhbHNlOyB9XG5cblx0XHQvLyBwZWVrIGF0IHRoZSB0b3AgdHdvIGJ5dGVzXG5cdFx0dmFyIGNvZGVzID0gc3RyZWFtLnBlZWtCeXRlcygyKTtcblx0XHRyZXR1cm4gY29kZXNbMF0gPT09IDB4MjEgJiYgY29kZXNbMV0gPT09IDB4RkU7XG5cdH0sXG5cdHBhcnRzOiBbXG5cdFx0eyBsYWJlbDogJ2NvZGVzJywgcGFyc2VyOiBQYXJzZXJzLnJlYWRCeXRlcygyKSwgc2tpcDogdHJ1ZSB9LFxuXHRcdHN1YkJsb2Nrc1xuXHRdXG59O1xuXG4vLyBmcmFtZXMgb2YgZXh0IGFuZCBpbWFnZSBkYXRhXG52YXIgZnJhbWVzID0ge1xuXHRsYWJlbDogJ2ZyYW1lcycsXG5cdHBhcnRzOiBbXG5cdFx0Z2NlLFxuXHRcdGFwcGxpY2F0aW9uLFxuXHRcdGNvbW1lbnQsXG5cdFx0aW1hZ2UsXG5cdFx0dGV4dFxuXHRdLFxuXHRsb29wOiBmdW5jdGlvbihzdHJlYW0pe1xuXHRcdHZhciBuZXh0Q29kZSA9IHN0cmVhbS5wZWVrQnl0ZSgpO1xuXHRcdC8vIHJhdGhlciB0aGFuIGNoZWNrIGZvciBhIHRlcm1pbmF0b3IsIHdlIHNob3VsZCBjaGVjayBmb3IgdGhlIGV4aXN0ZW5jZVxuXHRcdC8vIG9mIGFuIGV4dCBvciBpbWFnZSBibG9jayB0byBhdm9pZCBpbmZpbml0ZSBsb29wc1xuXHRcdC8vdmFyIHRlcm1pbmF0b3IgPSAweDNCO1xuXHRcdC8vcmV0dXJuIG5leHRDb2RlICE9PSB0ZXJtaW5hdG9yO1xuXHRcdHJldHVybiBuZXh0Q29kZSA9PT0gMHgyMSB8fCBuZXh0Q29kZSA9PT0gMHgyQztcblx0fVxufTtcblxuLy8gbWFpbiBHSUYgc2NoZW1hXG52YXIgc2NoZW1hR0lGID0gW1xuXHR7XG5cdFx0bGFiZWw6ICdoZWFkZXInLCAvLyBnaWYgaGVhZGVyXG5cdFx0cGFydHM6IFtcblx0XHRcdHsgbGFiZWw6ICdzaWduYXR1cmUnLCBwYXJzZXI6IFBhcnNlcnMucmVhZFN0cmluZygzKSB9LFxuXHRcdFx0eyBsYWJlbDogJ3ZlcnNpb24nLCBwYXJzZXI6IFBhcnNlcnMucmVhZFN0cmluZygzKSB9XG5cdFx0XVxuXHR9LHtcblx0XHRsYWJlbDogJ2xzZCcsIC8vIGxvY2FsIHNjcmVlbiBkZXNjcmlwdG9yXG5cdFx0cGFydHM6IFtcblx0XHRcdHsgbGFiZWw6ICd3aWR0aCcsIHBhcnNlcjogUGFyc2Vycy5yZWFkVW5zaWduZWQodHJ1ZSkgfSxcblx0XHRcdHsgbGFiZWw6ICdoZWlnaHQnLCBwYXJzZXI6IFBhcnNlcnMucmVhZFVuc2lnbmVkKHRydWUpIH0sXG5cdFx0XHR7IGxhYmVsOiAnZ2N0JywgYml0czoge1xuXHRcdFx0XHRleGlzdHM6IHsgaW5kZXg6IDAgfSxcblx0XHRcdFx0cmVzb2x1dGlvbjogeyBpbmRleDogMSwgbGVuZ3RoOiAzIH0sXG5cdFx0XHRcdHNvcnQ6IHsgaW5kZXg6IDQgfSxcblx0XHRcdFx0c2l6ZTogeyBpbmRleDogNSwgbGVuZ3RoOiAzIH1cblx0XHRcdH19LFxuXHRcdFx0eyBsYWJlbDogJ2JhY2tncm91bmRDb2xvckluZGV4JywgcGFyc2VyOiBQYXJzZXJzLnJlYWRCeXRlKCkgfSxcblx0XHRcdHsgbGFiZWw6ICdwaXhlbEFzcGVjdFJhdGlvJywgcGFyc2VyOiBQYXJzZXJzLnJlYWRCeXRlKCkgfVxuXHRcdF1cblx0fSx7XG5cdFx0bGFiZWw6ICdnY3QnLCAvLyBnbG9iYWwgY29sb3IgdGFibGVcblx0XHRyZXF1aXJlczogZnVuY3Rpb24oc3RyZWFtLCBvYmope1xuXHRcdFx0cmV0dXJuIG9iai5sc2QuZ2N0LmV4aXN0cztcblx0XHR9LFxuXHRcdHBhcnNlcjogUGFyc2Vycy5yZWFkQXJyYXkoMywgZnVuY3Rpb24oc3RyZWFtLCBvYmope1xuXHRcdFx0cmV0dXJuIE1hdGgucG93KDIsIG9iai5sc2QuZ2N0LnNpemUgKyAxKTtcblx0XHR9KVxuXHR9LFxuXHRmcmFtZXMgLy8gY29udGVudCBmcmFtZXNcbl07XG5cbm1vZHVsZS5leHBvcnRzID0gc2NoZW1hR0lGOyJdfQ==\n\n\n/*** EXPORTS FROM exports-loader ***/\nexports[\"GIFuctJS\"] = (GIF);","var BlobCreator = {\r\n    createBlob: function(uint8Arr, options){\r\n        var blob;\r\n        try {\r\n            blob = new Blob( uint8Arr, options )\r\n        } catch (e) {\r\n            // TypeError old chrome and FF\r\n            window.BlobBuilder = window.BlobBuilder || \r\n                                    window.WebKitBlobBuilder || \r\n                                    window.MozBlobBuilder || \r\n                                    window.MSBlobBuilder;\r\n            if(e.name == 'TypeError' && window.BlobBuilder){\r\n                var bb = new BlobBuilder();\r\n                bb.append(uint8Arr[0].buffer);\r\n                blob = bb.getBlob(options.type || 'image/png');\r\n            }\r\n            else if(e.name == \"InvalidStateError\"){\r\n                // InvalidStateError (tested on FF13 WinXP)\r\n                blob = new Blob( [uint8Arr[0].buffer], options);\r\n            }\r\n            else{\r\n                throw Error('Not Supported Blob Constructor!')\r\n                // We're screwed, blob constructor unsupported entirely   \r\n            }\r\n        }\r\n        return blob;\r\n    }\r\n}\r\n\r\nexport default BlobCreator;","import BlobCreator from './blob-creator'\r\nimport GIF from '../bower_components/gif.js/dist/gif'\r\nimport { GIFuctJS } from 'exports-loader?GIFuctJS=GIF!../bower_components/gifuct-js/dist/gifuct-js'\r\n\r\n/**\r\n * constructor\r\n * @param {*} options \r\n */\r\nvar EasyGif = {\r\n    /**\r\n     * 1.修复Worker不能传递CanvasPixelArray的问题\r\n     * 2.修复BLOB构造BUG\r\n     */\r\n    fixCompatibility: function(){\r\n        GIF.prototype.getContextData = function(ctx){\r\n            var data = ctx.getImageData(0, 0, this.options.width, this.options.height).data;\r\n            if(/CanvasPixelArray/.test(Object.prototype.toString.call(data))){\r\n                data = EasyGif.toUint8Array(data);\r\n            }\r\n            return data;\r\n        }\r\n\r\n        // 将代码中的\"new Blob\"替换成 \"BlobCreator.createBlob\"\r\n        var sourceCode = GIF.prototype.finishRendering.toString();\r\n        sourceCode = sourceCode.replace('new Blob', 'createBlob');\r\n        GIF.prototype.finishRendering = new Function('createBlob', 'return (' + sourceCode + ')')(BlobCreator.createBlob);\r\n    },\r\n    toUint8Array: function(data){\r\n        var uintArray = new Uint8Array(data.length);\r\n        for(var i=0,l=data.length; i<l; i++) {\r\n            uintArray[i] = data[i];\r\n        }\r\n        return uintArray;\r\n    },\r\n    frameToImageData: function(ctx, frame) {\r\n        var totalPixels = frame.pixels.length;\r\n        var imgData = ctx.createImageData(frame.dims.width, frame.dims.height);\r\n        // var patchData = window.Uint8ClampedArray ? new Uint8ClampedArray(totalPixels * 4) : imgData.data;\r\n\t\tvar patchData = imgData.data;\r\n\t\tfor(var i=0; i<totalPixels; i++){\r\n\t\t\tvar pos = i * 4;\r\n\t\t\tvar colorIndex = frame.pixels[i];\r\n\t\t\tvar color = frame.colorTable[colorIndex];\r\n\t\t\tpatchData[pos] = color[0];\r\n\t\t\tpatchData[pos + 1] = color[1];\r\n\t\t\tpatchData[pos + 2] = color[2];\r\n\t\t\tpatchData[pos + 3] = colorIndex !== frame.transparentIndex ? 255 : 0;\r\n\t\t}\r\n\t\treturn imgData;\r\n    },\r\n    decoder: function (arrayBuffer) {\r\n        return new GIFuctJS(arrayBuffer);\r\n    },\r\n    encoder: function (options) {\r\n        return new GIF(options);\r\n    }\r\n};\r\nEasyGif.fixCompatibility();\r\nexport default EasyGif;","import EasyGif from './easy-gif'\r\nexport { EasyGif };"],"sourceRoot":""}