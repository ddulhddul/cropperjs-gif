<html>
  <head>
    <title>easy-gif-js</title>
  </head>
  <body>
    <div>GIF encoded: <br/><img id="preview"/></div>
    <div></div>
    <code>
        <pre id="code"></pre>
    </code>
  </body>
  <script src="dist/main.js"></script>
  <script>
    var code = function(){
        var URL = window.URL||window.webkitURL;
        var increaseCanvas = (function(){
            var i = 0;
            return function(){
                var canvas = document.createElement('canvas');
                canvas.width = 200;
                canvas.height = 200;
                var g = canvas.getContext("2d");
                
                g.fillStyle = '#fff';
                g.font = "20px 黑体";
                g.fillRect(0,0,canvas.width,canvas.height);
                g.fillStyle = '#000';
                g.fillText(i, 20, 20);
                i++;
                return canvas;
            };
        })();
        
        var createGifImg = function(callback){
            var encoder = EasyGif.encoder({
                workers: 2,
                quality: 10,
                workerScript: "dist/gif.worker.js",
                width: 200,
                height: 200
            });
            encoder.addFrame(increaseCanvas(), {delay:200});
            encoder.addFrame(increaseCanvas(), {delay:200});
            encoder.addFrame(increaseCanvas(), {delay:200});
            encoder.addFrame(increaseCanvas(), {delay:200});
            encoder.addFrame(increaseCanvas(), {delay:200});
            encoder.addFrame(increaseCanvas(), {delay:200});
            encoder.on('finished', function(blob){
                document.all.preview.src = URL.createObjectURL(blob);
                callback && callback(document.all.preview, blob)
            })
            encoder.render();
        }
        createGifImg();
        // var decoder = EasyGif.decoder({
        // });
    }
    document.all.code.innerText = code.toString();
  </script>
</html>
